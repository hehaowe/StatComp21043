<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Haowei He" />

<meta name="date" content="2021-12-14" />

<title>homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>
<script src="data:application/javascript;base64,JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXsKICAgIGlmICh0eXBlb2YgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJ0b29sdGlwIl0nKS50b29sdGlwKCk7CiAgICB9CiAgICBpZiAoJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgJCgnW2RhdGEtdG9nZ2xlPSJwb3BvdmVyIl0nKS5wb3BvdmVyKCk7CiAgICB9Cn0pOwo="></script>
<link href="data:text/css,%0A%2Elightable%2Dminimal%20%7B%0Aborder%2Dcollapse%3A%20separate%3B%0Aborder%2Dspacing%3A%2016px%201px%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dminimal%20td%20%7B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0A%7D%0A%2Elightable%2Dminimal%20th%20%7B%0Amargin%2Dleft%3A%205px%3B%0Amargin%2Dright%3A%205px%3B%0A%7D%0A%2Elightable%2Dminimal%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%2300000050%3B%0Aempty%2Dcells%3A%20hide%3B%0A%7D%0A%2Elightable%2Dminimal%20tbody%20tr%3Afirst%2Dchild%20td%20%7B%0Apadding%2Dtop%3A%200%2E5em%3B%0A%7D%0A%2Elightable%2Dminimal%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dminimal%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dclassic%20%7B%0Aborder%2Dtop%3A%200%2E16em%20solid%20%23111111%3B%0Aborder%2Dbottom%3A%200%2E16em%20solid%20%23111111%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0Amargin%3A%2010px%205px%3B%0A%7D%0A%2Elightable%2Dclassic%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dclassic%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%200%2E14em%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%20caption%20%7B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20td%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20th%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%200%2E10em%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dclassic%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20%7B%0Aborder%2Dtop%3A%203px%20double%20%23111111%3B%0Aborder%2Dbottom%3A%203px%20double%20%23111111%3B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%203px%20double%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20caption%20%7B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20td%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20th%20%7B%0Apadding%2Dleft%3A%205px%3B%0Apadding%2Dright%3A%205px%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%23222222%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20tbody%20tr%3Alast%2Dchild%20td%20%7B%0Aborder%2Dbottom%3A%203px%20double%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23111111%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dclassic%2D2%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%20%7B%0Amin%2Dwidth%3A%20100%25%3B%0Awhite%2Dspace%3A%20nowrap%3B%0Atable%2Dlayout%3A%20fixed%3B%0Afont%2Dfamily%3A%20Roboto%2C%20sans%2Dserif%3B%0Aborder%3A%201px%20solid%20%23EEE%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Amargin%2Dbottom%3A%2010px%3B%0A%7D%0A%2Elightable%2Dmaterial%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23EEE%3B%0A%7D%0A%2Elightable%2Dmaterial%20th%20%7B%0Aheight%3A%2056px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0A%7D%0A%2Elightable%2Dmaterial%20td%20%7B%0Aheight%3A%2052px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Aborder%2Dtop%3A%201px%20solid%20%23eeeeee%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23f5f5f5%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Elightable%2Dstriped%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20%7B%0Amin%2Dwidth%3A%20100%25%3B%0Awhite%2Dspace%3A%20nowrap%3B%0Atable%2Dlayout%3A%20fixed%3B%0Afont%2Dfamily%3A%20Roboto%2C%20sans%2Dserif%3B%0Aborder%3A%201px%20solid%20%23FFFFFF12%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0Amargin%2Dbottom%3A%2010px%3B%0Abackground%2Dcolor%3A%20%23363640%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20th%20%7B%0Aheight%3A%2056px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Acolor%3A%20%23FFFFFF60%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%20td%20%7B%0Aheight%3A%2052px%3B%0Apadding%2Dleft%3A%2016px%3B%0Apadding%2Dright%3A%2016px%3B%0Acolor%3A%20%23FFFFFF%3B%0Aborder%2Dtop%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dmaterial%2Ddark%2Elightable%2Dstriped%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23FFFFFF12%3B%0A%7D%0A%2Elightable%2Dpaper%20%7B%0Awidth%3A%20100%25%3B%0Amargin%2Dbottom%3A%2010px%3B%0Acolor%3A%20%23444%3B%0A%7D%0A%2Elightable%2Dpaper%20tfoot%20tr%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A%2Elightable%2Dpaper%20tfoot%20tr%3Afirst%2Dchild%20td%20%7B%0Aborder%2Dtop%3A%201px%20solid%20%2300000020%3B%0A%7D%0A%2Elightable%2Dpaper%20thead%20tr%3Alast%2Dchild%20th%20%7B%0Acolor%3A%20%23666%3B%0Avertical%2Dalign%3A%20bottom%3B%0Aborder%2Dbottom%3A%201px%20solid%20%2300000020%3B%0Aline%2Dheight%3A%201%2E15em%3B%0Apadding%3A%2010px%205px%3B%0A%7D%0A%2Elightable%2Dpaper%20td%20%7B%0Avertical%2Dalign%3A%20middle%3B%0Aborder%2Dbottom%3A%201px%20solid%20%2300000010%3B%0Aline%2Dheight%3A%201%2E15em%3B%0Apadding%3A%207px%205px%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dhover%20tbody%20tr%3Ahover%20%7B%0Abackground%2Dcolor%3A%20%23F9EEC1%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dstriped%20tbody%20tr%3Anth%2Dchild%28even%29%20%7B%0Abackground%2Dcolor%3A%20%2300000008%3B%0A%7D%0A%2Elightable%2Dpaper%2Elightable%2Dstriped%20tbody%20td%20%7B%0Aborder%3A%200%3B%0A%7D%0A" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Haowei He</h4>
<h4 class="date">2021-12-14</h4>



<div id="section" class="section level1">
<h1>2021-9-16</h1>
<div id="section-1" class="section level2">
<h2>Section 1</h2>
<p>In this section,we use the data set women in R to make a regression analysis. The first part is the summary of regression results</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> height, <span class="at">data=</span>women)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)<span class="sc">$</span>coef</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>##              Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) -87.51667  5.9369440 -14.74103 1.711082e-09
## height        3.45000  0.0911365  37.85531 1.090973e-14
## [1] 0.9910098</code></pre>
<p>This is an example of simple linear regression. From the results of regression,we can see the <span class="math inline">\(R^2\)</span> is 0.9910098.Besides, the p value is under <span class="math inline">\(10^{-8}\)</span>,This means the linear regression is significant.</p>
<p>Then we can get some plots of this regression.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAilBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6OpA6kLY6kNtmAABmADpmAGZmZgBmZmZmkJBmtrZmtv9/f3+QOgCQOjqQOmaQkGaQtpCQtv+Q2/+2ZgC2Zjq2kDq2tma225C2/7a2///bkDrbtmbb25Db/7bb////tmb/25D//7b//9v///9xizUHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM3ElEQVR4nO2di5bjJhKG6YnbPZvYs5dpO5nEym52tEnLl/d/veUukGQVNyGw6z/HM91qhKTPUEAVIHJDzYqsfQOlCwEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBCgHtBlv7u1hGw+VrybAtUDajYf5+3rrXld8W4KlAZ02b/fOkI/n76veT/FyQLUUDgtArJkVLHXy37zcdljFbNkGmnycroekY+t9Zr561FU5sat3WQmQKgjhH6Vxp9GB1JqTUCEl1ZPQILrebvr8xkcSKs1Af3wxr52T0CyETlvVYEaHUgrIq9OtHK1YtTctawIcUCsltAicPnyjXz6Y/uV3s7uvCWEPXND+P8SEOvOcqn+2uhAYq1Zgl75QzNArAPG2k/WjtKyQA1KS2SXgz13Sw9IQOc3aWxUf210ILFWBXRrKQ8K6HpkpaB7OfHiwM2J/Of98uUkqo8E1ClrrH4YHUgsq5nPXcVujAwf4rCHZzgYBf5b/w+vfyUAojdKbcJStm4s3uWi9UIDoggmANHxM7VK7+tXMVa6O1ri21zDedEnbXbzJUj/MjLS9Ptklt08sMRtWmOx8+fv/JNFAtD57W+WDRoC4uWi66sYN9zX4+ZP3e8ZHUgrDYjdJLOImQHRVtxqxaZKELWOu74n3XAght9qdCCpehvE29Rd7iomWnbdD5q0QS+nRhYurm7YmIwOpJTRzDfsG8zWiEXr92GjNTqQROiTBoSAABmtWOaxWCUaliB0SQ80qmIY1bA1AoRFyNYIUFxUg1SjUECRUY1qGkV/QKoVi+tIPzCgzNddWwgIkCegZE77RwXE1BHplMly3bXlD0gFnePcHQ8MSPlb4jqKBQLiHsB2aDtCSpBwWca5dssD1HEwjQ5FyD5ikA1imbQPZoOal19pCbr+rJ6KGB8nGQl5UxbpcC0OkKhi/NHY9y/uj2A/yBAP1bydRClCQGPpMA2zQwhoLAtQqA267HdpXK6FAmIh4+sv/MHCW7EkKhSQiK6ZRxEQoABALksRWtla3vU7PjIgh6UIYqYXS/CEgByWIojRyPXIJsk8JyBgKYIaz7KpOXYqf1/42gqpYuBSBDWepUkLLkFu83eCjDS4FEFhuT8JZH1Anbw1oDQv1My3xJzuHp3dAhKjd7i3/MT9IF7F9JjrngLdHZuPJm6mXzWADq7ZGQ6zl1PLjHQUoVoAHcJcru1MD8czu/V0Bm3QYeZvI1n9IAaoeqe9bObvt2K8doWXoOqd9ov1g4QNUg15oAoANC9lnIOd9pErQkoHpBuvJ+4H3ZfZtIcHDuNUMiCr6xMeeo5TyYAshRjpFLM3iwU07DmHT8F7uKgG12hkgUba0NS4CwH1mhyXIiBATwloavh1z63xjICmBvB33T5PCGjsAppzinlPXqh/GvAI0KzTMKSjWPk0YNDLOpHaJ2H904AtGwT5nMPHYjMjDoeKWEorBvrkw0fzcx7F++GwokLPLhGLIBsETwMG94ArAZBTRCfYowhYoA7wyJYAyElP2A/iOrgGBJ8VkLOeKPTctwzO4eRbRNinutBz3/vx4RMROKws9OzXfx6e55Ow0tCzBORsnO3zfBJWGnrOV4JqDT0Tn7ks1mneCSsNPZMQPtgPgvQsgLyNs1JIKybGobW0YpGeg6DIKkdTCSB2odDSo873S3jZf90zC10HIMEn4mpBHcXrkewqAhR1tUCXa0s2/6sC0MFvJuZYoT7p87aSsM9UlND3fL+Eejvi8gGJ0pO7FUujHIBiGi+tRwaURN6h50rWzR8OiUJLC5Ug2hGYh7ggIEEm1jjr3JInZGqJ9Md25I5jdjlAwq0R3f8xsvNJ6Da7w5hKfS+Cvxggwo0zWQsQEzy7w5hK3eVe9SzJrAjIYXbHiiVIujXIijbIZZM37Y9dxwaJz1qtmNMmb+CGr4sAkqUnaf0NskGFbvKWpOc8VLDTvsBN3hYx/Y8y1DgckpllW+E2KNN1PXNMnm94K5bpui46sLpVDKDy1ouJ5e3FACpuNK/IlGKDMl8X0OHQFx1sxeayWqprHgAoyUsgkzzPod8LcuHBr1fCJC+BTPFAeu+RJeelhxjpFC+BTOaIWNp3G9YPin8JZOxzmcZ5UYX1pONfAvnAJSjNSyCjniuHcVYKaeZTvAQy6MGkMc5inPU1kydcLjtZYvJULfOiaROmzk4XE1F6chlnfXm/hPkX9faGxhxzFQuIKeuiXoMGUcYni3G2b8AnoUPYJ+GaVbO4ZDXO9g34JHQJ+9xds+p9Xas+rbHUNdzlOhv2SbdmVdan4HnOsQqyQQ5hn3RrVldeIR3SzEeEfSZj86P5jkMma5UeplX7QQIEG9hZFn/YSq3JZ1FAcwEi0n/OP37cLn//bv0pYzsOKAAQOHusTzgLSIEYliAL0GrGWSnEo+jahXYEJFZRD69UbwlyX+7sCIi908vqVGkbtHbpYQrvKMJytEHMf8uqmfFHUgyfiKFGgusKEKMSxFUEnVtERzHhdbuJFbCl8AmqYkncHdXIG1BueVzYY/wScCP5s0x+4UIAJQk9h1w4YdJFASUJPYdcOGHSJQGlCT0HXDhl0mUBpQg9B1w4ZdIlAaUJPQdcOGXSRW1QktBzyIUTJl22mU8Reg66cLqkj9QPqkW9kZYD7ySzgR9II0Bxm7w9niSgph/FpViR8EAalSCULTTSgBSg83Y37eJ6dklAfIzKfIrZBqu1SBlp5pDmgZ+516k/owQgHvMRbnvsB9lSgN5VZAwB2TIACfOTa7BaiwwbxKcGpQmPPZAkoO7ldNmzsuMcoY+Xm+fJp+uxhC9L9YM6PnfqvM1Xwdx2S2Ozbl1n3kbuvzat1XrSnVP8RMwDcOt6uOXoq7UAdWTn0l7KhsOprLnl6KsVx2JOgN5Ojildc/RV4YCE+XE1QggoQY6+KhzQM1axVnktExtpxxx9VXgJ8mnmnxKQV0fxKQGxGuk81HgwQHUIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQICWA9RvJ/Nf172buvfpfZ76gx0BQ/UykzSv4lm6BIn5T673ejed+oPYKpWv3AIzeUpAciLV7JKtOgH9a0vERqh6dpn44fLlG5vbLA6faaLNX3uVji/QIvw8/aJuWXT4Cn91XKf5Suv0u85Evh5eXI8dDdxgKw8gajZa+ZFLG9kTsMdkM/vVYW062AFGQ60gkYBEbjc+D0gD6tOIC6hM2EdlrJcLBigPoB2vF3q9lZhYx9eH7IxlWP2ziZLC1xmzh5OA9EyzTnBgx4006iIakM44ZmJVNhtE/xEPSB9CGBH5NDd9WD2baWM6QmYB2Wk4FQ3IyDicUFZAst2XgOTT3PRhDUhVJWpCPv3Rl6DJKmalGQBSGYttWEu2QWYJuqlmyC5BMp1Zgvj/RhXrjfTmQ+Vpp5kqQUpN2ILunIB0y2vYoHejQR7aIG46ur6K8Wb+etz8yQ26MDl2GhuQ3dIHtvs5AYk1jeyb7FsxvQt6I0y2bsWux1dRMMiuf7aGE2Ir2yinD/rTu51GWmazFWMZ86IU+L6HrIB4v4TbS9UPEk+uDjeDfhCfAtzIgsbV6Z362Ejmq7BBfRre7g/6QaKIBW+ZUOdg9fd8+0PUCSijEBAgBAQIAQFCQIAQEKAMgMZd2OtxslNrJdS/dLM+WOjU6J3HVgHUOqwgnPUMzg8brFO7yL0k1gDkNCpKBehOaXVWHkDnLfOH7s7C88pdZq/Sx8de19WaA4+Gjgq+saED99NyF+qoDIycuDOnRu73kwsQ84dy9zPbUvdVbFPU0vEWG9ibLlc+Hu0Ie8rehTqR5cCJO3NqppcSRogD2slwjfK8sttu/rn5oMNZy+UqfEFyaK9dRjfx6iG2P81vIsuBE3fm1AJe7w3IdGvp++bu5F8/M3ex5XIV7mPT6SwBdSKAIerLyIk7c6r7O3kmtQIg+U3vzj/+9eVEq5vlcm3vARpmaTtxZ06tD5D0km3+/XprfqJtjOVyvVuChlnaTtyHKkHijs+f/0HN8w9vOup1M/zRrSMgl1Prs0Fipwne1HREBQ5vyinYN0W9C3UqS9uJO3NqJa2YCUjUBfY4ch5Cq7yosjPz6T9m6HSyHzRw4s6cWn4/aCS4Jx0RCh2eGhjM0FplND8zFuPFLMyuTp9awVhsrLnxUUeCg6BTp9Ywmq9bCAjQ/wEp5/4u5zADrAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>These plots aim to certify the classical hypothesis of linear regression. From the four plots, we can conclude the hypothesis such as normality ,zero-mean,homoscedasticity is satisfied.Besides,there are seldom outliers in the fourth plots. Therefore, this model is suitable to fit the data set.</p>
</div>
<div id="section-2" class="section level2">
<h2>Section 2</h2>
<p>In this section 2, we are prepared to use some tools in R to make pictures.The following plots demonstrate the curves of norm distribution with different scale parameters.In order to make the plots more vivid,we use different colors to represent different distributions and integrate them in the one axis.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>),<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">add=</span>F,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">2</span>),<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">3</span>),<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">4</span>),<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#legend(&quot;topleft&quot;, inset=0.01, title=&quot;norm curve&quot;, c(&quot;N(0,1)&quot;,&quot;N(0,2)&quot;,&quot;N(0,3)&quot;,&quot;N(0,4)&quot;),lty=c(1, 2), pch=c(15, 17), col=c(&quot;blue&quot;, &quot;red&quot;,&quot;green&quot;,&quot;orange&quot;))</span></span></code></pre></div>
</div>
<div id="section-3" class="section level2">
<h2>Section 3</h2>
<p>In this section,we use some functions in package kableExtra to make some tables.</p>
<p>In the first R code part,we use the function kable() and data set ‘mtcars’ directly to make a table.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">kable</span>(<span class="fu">head</span>(mtcars))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table1)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
disp
</th>
<th style="text-align:right;">
hp
</th>
<th style="text-align:right;">
drat
</th>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
qsec
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
am
</th>
<th style="text-align:right;">
gear
</th>
<th style="text-align:right;">
carb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
16.46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.875
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.320
</td>
<td style="text-align:right;">
18.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.215
</td>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
3.440
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Valiant
</td>
<td style="text-align:right;">
18.1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
225
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
2.76
</td>
<td style="text-align:right;">
3.460
</td>
<td style="text-align:right;">
20.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="section-4" class="section level2">
<h2></h2>
<p>For this part,although we generate a table about the head of mtcars, we can easily find the table is not elegant enough.The layout of this table is pretty muddled.In this way, we ought to improve the complexity of the code part to make a more elegant table.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span> <span class="fu">kable</span>(<span class="fu">head</span>(mtcars), <span class="st">&quot;html&quot;</span>)<span class="co">#generating a table of the head of mtcars.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">FALSE</span>,<span class="at">font_size=</span><span class="dv">15</span>)<span class="co">#set the size of words in the table</span></span></code></pre></div>
<table class="table table-hover" style="font-size: 15px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
disp
</th>
<th style="text-align:right;">
hp
</th>
<th style="text-align:right;">
drat
</th>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
qsec
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
am
</th>
<th style="text-align:right;">
gear
</th>
<th style="text-align:right;">
carb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
16.46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.875
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.320
</td>
<td style="text-align:right;">
18.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
258
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.215
</td>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet Sportabout
</td>
<td style="text-align:right;">
18.7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:right;">
3.440
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Valiant
</td>
<td style="text-align:right;">
18.1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
225
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
2.76
</td>
<td style="text-align:right;">
3.460
</td>
<td style="text-align:right;">
20.22
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>except for adjusting the font_size of words,we can also use some colors in the table to make some data more striking.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>mycolors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(n, <span class="st">&quot;Set1&quot;</span>)<span class="co">#use the function of brewer.pal to return a vector with ten different colors,each color is represented by a number with Hexadecimal.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)<span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable_styling</span>(<span class="st">&quot;hover&quot;</span>, <span class="at">full_width =</span> T,<span class="at">font_size=</span><span class="dv">15</span>) <span class="sc">%&gt;%</span><span class="co"># set the size of words in the table.</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">column_spec</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">bold =</span> T,<span class="at">color =</span> <span class="st">&quot;#E41A1C&quot;</span>, <span class="at">background =</span><span class="st">&quot;#FFFF33&quot;</span>) <span class="sc">%&gt;%</span><span class="co">#chose the  three to five columns to add the colors of words and background.the parameter color represents the color of words. </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">row_spec</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">bold =</span> T, <span class="at">color =</span> <span class="st">&quot;#A65628&quot;</span>, <span class="at">background =</span><span class="st">&quot;#999999&quot;</span>)<span class="co">#chose the  five to six columns to add the colors of words and background.</span></span></code></pre></div>
<table class="table table-hover" style="font-size: 15px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mpg
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
disp
</th>
<th style="text-align:right;">
hp
</th>
<th style="text-align:right;">
drat
</th>
<th style="text-align:right;">
wt
</th>
<th style="text-align:right;">
qsec
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
am
</th>
<th style="text-align:right;">
gear
</th>
<th style="text-align:right;">
carb
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mazda RX4
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
6
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
160
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
16.46
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Mazda RX4 Wag
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
6
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
160
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
110
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
2.875
</td>
<td style="text-align:right;">
17.02
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Datsun 710
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
4
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
108
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
93
</td>
<td style="text-align:right;">
3.85
</td>
<td style="text-align:right;">
2.320
</td>
<td style="text-align:right;">
18.61
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Hornet 4 Drive
</td>
<td style="text-align:right;">
21.4
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
6
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
258
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;">
110
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
3.215
</td>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
Hornet Sportabout
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
18.7
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
8
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
360
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
175
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
3.15
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
3.440
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
17.02
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
0
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
0
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
3
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
2
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
Valiant
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
18.1
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
6
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
225
</td>
<td style="text-align:right;font-weight: bold;color: #E41A1C !important;background-color: #FFFF33 !important;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
105
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
2.76
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
3.460
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
20.22
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
1
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
0
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
3
</td>
<td style="text-align:right;font-weight: bold;color: #A65628 !important;background-color: #999999 !important;">
1
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2021-9-23</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4,3.11 and 3.20(pages94-96,Statistical Computating with R).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>3.4: The question 3.4 aims to Develop an algorithm to generate random samples from a Rayleigh(σ)distribution.Because the Rayleigh(σ) is a continuous function,the density function is <span class="math display">\[f(x)=\frac{x}{\sigma^2}\exp{-\frac{x^2}{2\sigma^2}}\qquad x\geq{0}, \sigma\geq{0}\]</span>.</p>
<p>we can use the inverse transform method to generate random samples.So we can define the inverse function<span class="math display">\[f^{-1}(y)=\sqrt{-2\sigma^2\ln{y}}\qquad y&gt;0\]</span>,we can use this inverse it to make a code.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>inverse_function<span class="ot">&lt;-</span><span class="cf">function</span>(theta,y)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>theta<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(y)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">inverse_function</span>(<span class="dv">2</span>,y)<span class="co">#theta is 2</span></span></code></pre></div>
<p>So we would only change the parameter of inverse_function()to get the random samples of Rayleigh distribution with different thetas.</p>
<p>This part aims to compare the histogram of samples and curve of density function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>inverse_function<span class="ot">&lt;-</span><span class="cf">function</span>(theta,y)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>theta<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(y)))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>rd<span class="ot">&lt;-</span><span class="fu">inverse_function</span>(<span class="dv">2</span>,y)<span class="co">#the random numbers of Rayleigh distribution,theta equals to 2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rd,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)<span class="co">#density histogram of sample with theta equals to 2</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>((x<span class="sc">/</span><span class="dv">4</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span>),<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">add=</span><span class="cn">TRUE</span>)<span class="co">#density curve of density function of Rayleigh distribution with theta equals to 2</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histogram and density plot suggests that the empirical and theoretical distributions approximately agree.</p>
<p><br />
3.11: The components of the mixture have N(0,1)and N(3,1)distribution s with mixing probabilities p1 and p2=1−p1.This part we aim to generate this mixture function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(1234)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.25</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>norm_1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>norm_2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>weight<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))<span class="co">#generate the weight of norm_1 and norm_2.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>mixture<span class="ot">&lt;-</span>weight<span class="sc">*</span>norm_1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>weight)<span class="sc">*</span>norm_2<span class="co">#the mixture distribution</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mixture,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(mixture),<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This part is about the histogram of mixture of normal distributions and the density of this mixture distribution.</p>
<p>The next part we would to conjecture about the values of p1 that produce bimodal mixtures.we use a seq(0,1,0.1) to represent p1 to generate the plot</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(1234)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>norm_1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>norm_2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>mixture_function<span class="ot">&lt;-</span><span class="cf">function</span>(p1)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>weight<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))<span class="co">#generate the weight of norm_1 and norm_2.</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>mixture<span class="ot">&lt;-</span>weight<span class="sc">*</span>norm_1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>weight)<span class="sc">*</span>norm_2<span class="co">#the mixture distribution</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mixture,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(mixture),<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mixture_function</span>(p1[i])</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAADoAAGYAFwAAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtRDQBmAABmADpmAGZmOgBmOjpmOpBmkLZmtrZmtttmtv+QKACQOgCQOjqQOmaQZgCQZjqQZmaQ29uQ2/+2ZgC2Zjq22/+2/7a2///bkDrbkGbbtmbbtpDbtrbb25Db27bb/7bb/9vb////tmb/25D/27b//wD//7b//9v///99e3twAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMLklEQVR4nO2dC3ubRhOFV2riIidR07pq1KZ2Set+Uhypt7RCNtL//1vfLhchAcuZWdiafTrncSJbwBn23dkLAoE6ijqlnnsHxi4BBCSAgAQQkAACEkBAAghIAAEJICABBCSAgAQQkAACEkBAAghIAAEJICABBCSAgAQQkAACUtPNIZ5u+tr8NlM3tbdy2zhw/xqgP967+aeLq139vbYChOdvAFXv7WfRcAFyxYH7lxl0uFfq60Os9J+P+tf5g4mmvlpON+nixevpZr9U6uVKv/flvZr8uFSTu3zzfGWz4WSV7WG13Nhqj8D9p0WArbrTP6YG0sX04TE2xle7RJlXvWm6iHbmDb3Bw342uU2XecWdr5xXYbU8S9Ft8P6nAC9ud1mKJqa30v+Z10O17Z+/vlaGaJSlY9nsy5WrANXybJ3Dt4H7xwWgNEtBs1xXRLaNeT0FSJeT958XzQDlytYAx58C909Oo9jnexVZayDRRnmKMmsgnQXuvyib2ETj1+tdtuHf1SlAlDX3eoBmG64FWAfvfzYKvN0dPyq9QTEKJDP1dllu+1Fn8P1kVQ9QjAJHW4BEfRG4f9R5qDHEHDV0fysgPeJtHheOEy+CQvG3Z5A+PFFzjxUciL8czQMJICABBCSAgAQQkAACEkBAAghIAAEJICABBCSAgAQQUA4oXdTPK1Y6fFj1jtLlP4Q8+pcZtFWNc68mrso0wMdarf4Dypv/WRPTMe5qS/ezm0EyyOY/qPz4l4ASUwPpu0aqbCf/GwSQzb9jz1jdozf/sg+yfjZ5iCcWQIpehA7/uqUqbBnudP/LULT1uMb8EHxjr+5lEGKAIoNMbloTtFpwVsO8DOr0b90nagEc/I8cf7OSubjByHoJSMs25uWJWAK6/2UTowLi7n8Rirb7ZxlE9y5enshFcPCnFoDlf1EBdEDpu0+L9ulOkvnVe2kuILu/fZ84gLz6gzOr2cRiP7/MXX4G8cTPII/+xUpJpGfNjWlWkbn1BHYA1O7f3Bt+E2D5F1E4/vlKera8jeqJUmXQq7ZRzESgErL4d+0TCxDV37EPynJkfdPS0+1n9j6IA8jm37FP3E7al3+RQT9/+m7Fq2FeBvH9eRnk5k8JUPZB6urv76jHXHxAVH/3Poi9/0xALDkA4vtTC+Dor5iAtux5BA8Q259cAJZ/laFMQCkxPV1HMap/tU88QK7+hADOhxpFBOpcmnsowATE3n8moOOa81kcHxDfn1yAPv6UYaD8wMzhWIaTQexjPR4gqv8pQ1UBCAdwHsV4GdSuxrFerQB9hzH7seQJEIxQrKCr4Jb82XNRwzkgcgq1+NuP9coCEPeI7/+U++MIxUw6vlvftcxErSl6BohSCIt/41ivUQCCdy9/nEPVsdhdcyjo+LiDB8jibz/WKwvAONaj+FdNmAkoq4Gk8ZFlx8cdDhnU9G/uTb0AREJU/yIKH1A2DDQHgY4UPQGiNYN2f+sops4KQLHv4Y8idC+1NQF1Dsh9qLE1YaXoNdzXvx8gyzbqEpBzEWxNeChAFH8UIV+YHetZJ6ON82JNgT21+Ns+sRyTf7Zobbq3Q0y+PIK5+3b/9ibcjPCM/maZJRM7N1KX/3WK7V9EOP0DAbz6dwNqHwWGBtSyYFBAvfw7AVlGgf9eBtkuJLNF5gLiX6jGA+TTvzO2ZaLIBWSXpQkzAXn1d5koDgbI1oSHAjSEf49pWH85dB7/uv+zArI14TH5Pysg+0RuPP7PCygACSAgAQQkgIAEEJAAAnICtPb8tZSjufLZ341hWP4ugJLI3+Q31zYqJ3nP7u/YxDwDMtr6/Q4e1d8N0NZzEzv6rwLyFTmO/qzrTRzEuyTKoz8X0Lro3fw1gCzC/tobH6a/YyftOYO8Hd/z/V2Heb896NochHsMwfCXiSKQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQA6Dyirb0B84NjUL175FB5FtBBO3PALR/s1TfxOpmP//FPNxF/3r113x3+LDSC8xTXvqeLB6nPwfQ9cr8zLXr+mYdmRrY5wGuV1l19DzTMU5/DqDMMAtwiK92ZwHmu/yK5H7nIcbp7wZoP5usir/T/L40Sf+LMcbp7wTon9h8QdT88WqTZe3O5G/f6zHG6e8C6M3SnFqNzIO41url9/mdjQboREfpLxNFIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAAISQEBqujnEjHudW/TbrHGZem4bB+5fA/THezd/c8lx/b22AoTnf7y4U/5+5nitdluAXHHg/mUGHe6V+trcn3K6edS/zh+ym1V/tZxu0sWL19PNfqnUy5V+78t7NflxqSbFVfv5ymbD7K7W58uNrfYI3H9aBNiqO/1jaiBdTB8eY2N8tUuUedWbpotoZ97QGzzsZ5PbdJlX3PnKeRVWy7MU3Qbvfwrw4naXpWhieiv9n3k9VNv++etrZYhGWTqWzb5cuQpQLc/WOXwbuH9cAEqzFDTLs5ts6m3M6ylAupy8/7xoBihXtgY4/hS4f3IaxT7fq8haA4k2ylOUWQPpLHD/RdnEJhq/Xu+yDf+uTgGirLnXAzTbcC3AOnj/s1Hg7e74UekNilEgmam3y3LbjzqD7yereoBiFDjaAiTqi8D9I/Bsn/5z1ND9rYD0iLd5XPi7LXgo/vYM0ocnau6xggPxl6N5IAEEJICABBCQAAISQEACCEgAAQkgIAEEJICABBCQAALKAaULv09aCdi/zKCt56fRBOt/1sS2nh/MF6Z/CSgxNcB66JlidV98f568+Zd9EO2zyfzB96r4lR6F6l+L5dWfGMNlFOMDcgnyLwSgA8pyk5ygJSBGDRP9LzN0eP9aKEoQs9xc3GBkvQSkZRtOARz9n3z5H0/++h8qxVkG0b1PAagal//x5E8ElL77tDA1gM+yXTQBcgHo/tU++fQ/lv6KnEE88WvY0V8NfSRUq2AGoCRKF+RplgMgN396P+fqTwV0+LDaRuRbpJ/VMFFU/5YaHtS/iFL6P3E66fUNd5hnAHL1JxSgjz8d0OHnT/l9p3kB6BnE9lfUAjj6MwHpQ5mrvwlPP66agGIBovpX+8QDxPc/AUKN2HUUo6d/D386IKrzZQUzAG2585QiAHX3Xf2pEdz9aYB4Dy+/CEDagurfUsO0Ttp9/4mA2IcCzAK4+5OqwKN/sZj4TA/XGuY9M0TlgRiA2P7sDLIcy2SP48i/xnC5jWJmkLs/LYP6+HcH6FxaPGmiPsHgA+L7P/EyiO3PBaSr4PZDo6Mrmna9hTsUYCT+py7i3J8CSKNe3zVnomUNvOpbAKq/QwH67z8FkDmWuWsZCvazyzbcWgC8/2R/hwL49j/LoITxkahLDY/WvzNA1Qe1TURto4BiFqCfPyWFvPk7jWKKXYBx+dcBdQXoDG4bZeoFcC0C2d/Nnurf2QjyRdmxXnMyahtlmgJ7GrB/tmhturdD3Lw8on0UaEYC+x+yv1lmycQuqeKIpvq1Q0H7UwC1LBi0AKP2lwyiAFrkLZFxZpJXgJD9u2O3T7RYAUL3d5kosgKE7u8yURxMIfiTMuiVpwKE4N+dvdaJ1kAKwN+5//uvSAABCSAgAQQkgIAEEJAbIHNlsr8bt4zK3w3QNionYX40In/3Jrb1+x25sfg7A/L41aZR+TufMGBdshSwPx/Q2vRv+2tv+z8yf7cM8nb8PT5/N0Brc5DssRMdkb9MFIEEEJAAAhJAQAIISAABCSAgAQQkgIAEEJAAAhJAQAIISAABCSAgAQQkgIAcAJVXtKU/cG5oFKp/jwwi3woiaH8GoP2bpfomVjf7+S/m4S7616u/5rvDh5VeYJ7y0vdk8Tj9OYCuV+Znrl3XN+vI1MA+D3C9yqqD9d3sUPw5gDLDLMAhvtqdBZjv8iuS+52HGKe/G6D9bLIq/k7z+9Ik/S/GGKe/E6B/YvMFUfPHq02WtTuTv32vxxinvwugN0uNex2ZB3Gt1cvv8zsbDdCJjtJfJopAAghIAAEJICABBCSAgAQQkAACEkBAAghIAAEJICABBCSAgAQQkAAC+j8P6FVWGC1LDgAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>for the 11 plots,we can see when p1 is in the interval of (0.5,0.6),These values produce bimodal mixtures.</p>
<p><br />
3.20</p>
<p>Write a program to simulate a compound Poisson(λ), the function of the compound Poisson(λ) is <span class="math display">\[X(t)=\sum_{i=1}^{N{(t)}} Y_{i}\]</span> <span class="math inline">\(Y_{i}\)</span> has a gamma distribution,and <span class="math inline">\(N(t)\)</span> is a poisson process,so we would generate the gamma distribution and Poisson process.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>compound_Poisson_process<span class="ot">&lt;-</span><span class="cf">function</span>(lamada,t,shape,rate)<span class="co">#t represents the time of compound Poisson process</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  Poisson_process<span class="ot">&lt;-</span><span class="cf">function</span>(lamada,t)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="dv">1</span>,t<span class="sc">*</span>lamada)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="fu">Poisson_process</span>(lamada,t),shape,rate)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(u))<span class="co">#sum(u)represents sum of random variables</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">30000</span>,<span class="fu">compound_Poisson_process</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">mean</span>(results)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">var</span>(results)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(x1,y1))</span></code></pre></div>
<pre><code>## [1] 16.00282 15.88156</code></pre>
<p>This code mode simulates a compound Poisson(λ)–Gamma process,we define <span class="math display">\[λ=2,t=10,shape=4,rate=5\]</span>In order to get a precise result,we process simulations for 30000 times.The mean of the simulations is 16.0028248,and the sample variance of simulations is 15.8815645.</p>
<p>because <span class="math display">\[E[X(t)]=λ(t)E(Y_{1})\quad Var[X(t)]=λ(t)E({Y_{1}}^2)\]</span></p>
<p>for<span class="math inline">\(λ=2,t=10,shape=4,rate=5\)</span> we can calculate the <span class="math display">\[E[X(t)]=16\quad Var[X(t)]=16\]</span>, 16.0028248 and 15.8815645 is approximately equal to them respectively.</p>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2021-9-30</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4,5.9，5.13，and 5.14(pages149-151,Statistical Computating with R).</p>
</div>
<div id="answers" class="section level2">
<h2>Answers</h2>
<p><br />
5.4:<br />
This question aims to Write a function to compute a Monte Carlo estimate of the Beta(3,3) cdf, so we should generate a large quantity of random numbers of the Beta(3,3), and then create a empirical distribution of the Beta(3,3). using this empirical distribution to estimate the cdf.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>beta_rd<span class="ot">&lt;-</span><span class="cf">function</span>(N,shape,rate)<span class="co">#use the random numbers of gamma distributions to generate the random numbers of beta distribution.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,shape,rate)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  v<span class="ot">&lt;-</span><span class="fu">rgamma</span>(N,shape,rate)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  rd<span class="ot">&lt;-</span>u<span class="sc">/</span>(u<span class="sc">+</span>v)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>empirical_beta<span class="ot">&lt;-</span><span class="cf">function</span>(x,N)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">beta_rd</span>(N,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  v<span class="ot">&lt;-</span><span class="fu">as.integer</span>(u<span class="sc">&lt;</span>x)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(v)<span class="sc">/</span>N)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(X))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>u[i]<span class="ot">&lt;-</span><span class="fu">empirical_beta</span>(X[i],<span class="dv">100000</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>F<span class="ot">&lt;-</span><span class="fu">pbeta</span>(X,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>Fn<span class="ot">&lt;-</span>u</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>x_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">rbind</span>(X,Fn,F)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">12</span>)<span class="co">#set the size of words in the table</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#data.frame(&#39;x&#39;=X,&#39;Fn&#39;=u,&#39;F&#39;=pbeta(X,3,3))</span></span></code></pre></div>
<table class="table table-hover" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
X
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.10000
</td>
<td style="text-align:right;">
0.20000
</td>
<td style="text-align:right;">
0.30000
</td>
<td style="text-align:right;">
0.40000
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.60000
</td>
<td style="text-align:right;">
0.70000
</td>
<td style="text-align:right;">
0.80000
</td>
<td style="text-align:right;">
0.90000
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Fn
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00874
</td>
<td style="text-align:right;">
0.05877
</td>
<td style="text-align:right;">
0.16476
</td>
<td style="text-align:right;">
0.31820
</td>
<td style="text-align:right;">
0.50048
</td>
<td style="text-align:right;">
0.68302
</td>
<td style="text-align:right;">
0.83642
</td>
<td style="text-align:right;">
0.94191
</td>
<td style="text-align:right;">
0.99197
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00856
</td>
<td style="text-align:right;">
0.05792
</td>
<td style="text-align:right;">
0.16308
</td>
<td style="text-align:right;">
0.31744
</td>
<td style="text-align:right;">
0.50000
</td>
<td style="text-align:right;">
0.68256
</td>
<td style="text-align:right;">
0.83692
</td>
<td style="text-align:right;">
0.94208
</td>
<td style="text-align:right;">
0.99144
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>In this part of code, the empirical_beta represents the empirical function of beta distribution, we use 100000 random numbers of beta(3,3) to genrate this empirical function.Compared with the cdf of Beta distribution, we can conclude that the value of two functions is approximately equal.</p>
<p><br />
5.9<br />
This questions aim to implement a function to generate samples from a Rayleigh(σ)distribution,using antithetic variables.</p>
<p>In this situation, we can use the inverse transformation method to generate random numbers of Rayleigh(σ)distribution.</p>
<p>Rayleigh(σ) is a continuous function,the density function is <span class="math display">\[f(x)=\frac{x}{\sigma^2}\exp{-\frac{x^2}{2\sigma^2}}\qquad x\geq{0}, \sigma\geq{0}\qquad.\]</span></p>
<p>So we can define the inverse function as<span class="math display">\[f^{-1}(y)=\sqrt{-2\sigma^2\ln{(1-y)}}\qquad y&gt;0\qquad.\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>anti <span class="ot">&lt;-</span> <span class="cf">function</span>(N,sigma,<span class="at">antithetic =</span> <span class="cn">TRUE</span>) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#set.seed(1234)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)<span class="co">#using antithetic method</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>antithetic)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  Y1<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>v))<span class="co">#inverse function method to generate random numbers of Rayleigh(σ)distribution.</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  Y2<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">&lt;-</span>(Y1<span class="sc">+</span>Y2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> v</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  Y1<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>v))<span class="co">#inverse function method to generate random numbers of Rayleigh(σ)distribution.</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  Y2<span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">&lt;-</span>(Y1<span class="sc">+</span>Y2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Y)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>sd_anti<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  sd_anti[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(<span class="fu">anti</span>(<span class="dv">10000</span>,sigma[i],<span class="cn">TRUE</span>))</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  sd[j]<span class="ot">&lt;-</span><span class="fu">sd</span>(<span class="fu">anti</span>(<span class="dv">10000</span>,sigma[j],<span class="cn">FALSE</span>))</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>reduction<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>sd_anti<span class="sc">/</span>sd</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(sigma,sd,sd_anti,reduction)</span></code></pre></div>
<pre><code>##                [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
## sigma     1.0000000 2.0000000 3.0000000 4.0000000 5.0000000 6.0000000 7.0000000
## sd        0.4613703 0.9277589 1.4031245 1.8353960 2.3072857 2.7863294 3.2785021
## sd_anti   0.1046867 0.2180638 0.3162248 0.4385394 0.5340248 0.6562751 0.7451570
## reduction 0.7730961 0.7649564 0.7746281 0.7610655 0.7685485 0.7644661 0.7727142
##                [,8]      [,9]      [,10]
## sigma     8.0000000 9.0000000 10.0000000
## sd        3.7127669 4.1768374  4.6463301
## sd_anti   0.8146112 0.9394936  1.0668876
## reduction 0.7805919 0.7750706  0.7703806</code></pre>
<p>According to the results of antithetic methods,we can see the mean of random numbers is approximately equal.And the percent reduction in variance of<span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span> for independent X1,X2 is about 70 percent, so the effect is apparently significant.</p>
<p>5.13 and 5.14<br />
In this question,we would find two importance functions f1 and f2 that are supported on<span class="math inline">\((1,\infty)\)</span> and are ‘close’ to g(x),and then we would estimate that<span class="math display">\[\int_1^{\infty}\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}dx\]</span>.However,according to property of symmetry of <span class="math inline">\(f(x)=\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}\)</span> and propriety of pdf,we can conclude that the calculus of <span class="math inline">\(\int_0^{\infty}\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}dx\)</span> is 0.5,<span class="math display">\[\int_1^{\infty}\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}dx=0.5-\int_0^{1}\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}dx\]</span>.we just need to calculate the value of <span class="math inline">\(\int_0^{1}\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}dx\)</span></p>
<p>We choose the <span class="math inline">\(f_{1}=\frac{1}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}\)</span>,<span class="math inline">\(f_{2}=\exp{(-x)}\)</span> and <span class="math inline">\(f_{3}=3x^2\)</span> as importance functions.And next plots are curves of these functions in the interval(0,3).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi),<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">add=</span>F,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">main=</span><span class="st">&quot;importance function&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(<span class="sc">-</span>x),<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi),<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">3</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrYA/wA6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmkLZmkNtmtttmtv+QOgCQOmaQZgCQZjqQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////AAD/tmb/25D/27b//wD//7b//9v////oay8AAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM1UlEQVR4nO2dC3vbthWGabt2ZHdpk0lddkvUdevCbm3ack232bQj8f//qBIEQYIWiXMBQELS+Z6nqW0RBPHq4ODgyqwSOZUt/QCpSwABEkCABBAgAQRIAAESQIAEECABBEgAARJAgAQQIAEESAABEkCABBAgAQRIAAESQIAEECABBEgAARJAgAQQIAEESAABEkCABBAgAQRIAAESQIAEEKBAgPbb7Oaek+5fP7Oy++4uy15jM+A+XKNlAT29uWQBKrNaa2wGKQBiKs94gIrs4n3UDHqFtKDdJlt9fJldvK3+c5ddqxLUz/f9H7Ps+kNz0cf6x8/+or7LuoD/eJNdvlGGUJfgo/rhi/f6g39+l+nEVfXLyzrB2+b+9R8vXhszyFW6i/e69HWu66mEzYWXP7UWNMjfunpOQFov24LrB2wK0zxVI/Ws+sebv+nryv6iwk7Qpl43EJSuf3YAGks4AHSQf4axwx5Q+5jZOy9A6+qX+h5v1SOsmye9/KD+sqqqxzv1bPrv9b83H6r/6hpQp31xrz7WH9Tmpi+qH+j3908bdUmubqOvaKSr2DNAEwmND3qWf3c1DpCqHV1RGdXWAKofQf+rS5Nr3nn3rO3PRfs9dC7i13+/bCjqD+rEK/Nh8eqHlkH9oXmyUUAjCW1Ah/nrq1GAdn+wmQx/IwFaGdYGUPNQqjymKWnKZpys/nz/jbbdlSl5cwur7alvNqwSY4DGElqARvLvrQIE5C03oNrm35mnUT8PAdVps+u//7o5BGQe39T+UUCmbo4ltACN5J8OILcF6Ut3I4AsCxp6RgjQEVnQlA+yAJXGIQzL2SYov/j2sCRF2+Spf8tsOuG0DyIC2m3WXRvNiqymAU20YhpQ8//mg6ftcx+kSv5affE1vlwFV0+bzjIMoPpeKuF6MmHz57FWLB0L6qEP4hANqGzDlDEn3aVedXFQF7boyzrf/bzIfUKTwUEclAygy5/qJuqVFUn/tS+gDpCvP6hW7Prb4tD2m4C4SfD0zV13mz79Yx2Bv/r+eStmJ2wy+MGOpK38qYCar4nfqxuTf1docVmRtO4PIHuBOJ0SoP1Wt6R5SBs6JUC7r7TplCGLdEqAjAUVYb3Q0cvuzStCBa83f7rqq5gJFLmx4olKZjUACSBAAgiQAAIkgAAJIEAGUI6ZpzxHGUDli62E0GMyI4rYudyzk1gQIPFBgKQVA0QDtN+eXW+WBKgwk/0lavXSSYgCaL/tsJzPsBoF0G7TDaYFHZhNWgZQYVYGFdNFP2cLUrM9u42aRnMA6sdjz84HadvYq1jRBagblz0b++m7Gt2kmBPQGcq2oFr5SgANZXxQi2W3gYPAErU69FTUt2K6ku23LkB5lq0fv7y3G/xTFymSVvP2uV7jcDZumhwoPn6uAE0FilkA3Ya4CSgaINwy4N2mCQb+V01b0ES+n7CPo3RLuZgrIiDkQvKuhdOorLsAX8wEoIfxP89BiAqowm1FKMzSwqmLggCaQwxAMfOdqmIAoav2vwiiAwqzgCoQIFXJrq40G/P/sOIDwkXSU1dRDRLrhYIzogLKezfr1U8PVWOjE+Jb0Ez5OnV1ddiQBa5odEDWaFjwfF1h0Egli+SXB2JYEKZ7Bc5q0AEt1NZz4iDYO8OzGgxAE4TGosWApsWxoAywDsyYtD8gA2E0nA7niKIEiohZDQ6ggXoC44Twd3IrCiC2BeFlARjvkYUi5FHFHLUMntXwBDRH+6XF6qzCK+3BWQ0eoAUaMk4cFGKvBtMH4RuyUFaWVmcVdtKjhCbGhYIQ4luQ334xditGIhQAEccHeew4BEYUcc38YbEjDi1ymvkQe1bDAopIKLERRYQe5mvilY4P0BWprfemyQCkZioK3zrmw5vS1nsTYgCqm6/Hu1WVw3vtqfkiu2IkQL6EeONBKpiOEAdhAE2XNw4hHqBcHQ6xCCBHaeO0ZJwqttpt1Pkbi1SxeZuwiumkm2OQvPhwAc3O5wib+UY0P+0j6uqOTaCFd1EAxfDTZAtS/YwAkFiArHLORohVxQJAYvkgu5jESsYmxPZBnpWNA2hYyJnCxZScNMWAZjOhSAuoWPmS1t9RNRcgz7NcnQNmUQFxFWURZ8h8O6FNIGw0lJIPcgtfR4I66qMBNFq6GaIhMiDMhjq9+LekLn9x+qBjAYTaUNcAaiYWJxcTBXLSxKlWBiEiINyGOgWoRUNYvMBpxOLPRZM7q5gNdQrQ411zJWH5C6uVd60PDiKWBVXAhrrwFkSuG0sBwm2o02s7VtXhXg16vlp05xGKEKMVw2yoa8/Rmd70TAPk4kOsZFTUxxEHcQAFWhST0IgitysWl1BCI4rsvmrUYCidEcVpPmCJYhKKMqKIWOdJAASXJ2Yli+OkgSZu9HYegKbl39hH6awqQsC8Ip6331zhrS+iKJ3VanK3Kn239QKTqQNF6ayGzHdpRemssvL1HJF2tGRe+4GidFZZ+U4AQpckEqEonVVL6E29vnycwdAIoViAsJ1Vcr7egCIRSqazOg5o4SasSgjQuI4UUAHue2Zu6vWUs082soEcc0/OGkX4SAHupl5fuQmxDiEgA8oR7yLjbMkc9UHkGubu13MIUQGhNkFxNvWOAWJ4oOCEUrGgMAYEit51jeWDqJt6AxlQeEVqxcibeucDRDQiOqDm7DZvLdibpw0R0QGZPQj7r1Md7oCGqIeAADtlrVHUb7/l9MUoA2b8GhaSEMcH6TDZ7xQh2Af5eCDaNIczJ5aT1q9H9lJcQAhCthW5suIAyrPs7TbslszAfDBCumqOk870AruQ40FLrADGtWYMQH/SphO0FQsPCOeGDKNpe+WNB/kf9Abl61/DHlCIQEKnCwhrQy2iqXM+EgUUxEUHWeGZCKDnPmjefqrLW6cJaO5+/K2uaGPZpjFoH42Pf0hNnXqOs9snXhiEa8sa3Y4SolqQ536xiXxjxol4RHVFO2zLWL35SDsOk1QaPmighUdan/VAzgMQ7UymASIOoOBnmA1cUBQDohG6suyI44OCn4JnA4pUwQitWfsQLSLGoH34cxQtQElM9dhiDHeEP4lzJkCs0+H4FuQ8y5W2umOu4TJSPWtDIlYcBJ4GvNTqDlD0Dj5ryBXaZzDDgduzKUocxD6yfQ490Bq0KFPPRAvqXNBcTRiFUJypZ9Lqjt5Fz9nGYyFFmnqmrO6Y3YC0kIQSmHo2gOaOEXG+KIGp5yWPDYIhRZp6XmYZMEcNIgemOFPP5EAxysvlCHqYbPyjTD2TA8VEuqhjkBYPFJUHSoRPZSqcDYo5YHZznztaMYIFJXmwm21LvAGzQh2X7CA0GSg+GzD79OnT0t4HEme4Y93YhXPHYaR3+ywgTiv2rgEU5T2r6YlvQTFeXZOg2D7I/fqsTqFeRLuY2NM+rEkN63ZHIwagcHLcdPqj5T8Jcbn3TZfHEBUQ2FkFb7o8hpiA4M4qeNPlMUQEhOhqgDddHkNEQIjOKnjT5TEwAbk6qUZnbUHliy0cQsOzGuAzLI+BBUgfsAkL7KyCz7A8hpgWdI6i+KCz1NH0LpeSAAIkgAAJIEACCJABhDuq9AzVAsIeVXp+0oCCHVV6ejJdjUBHlZ6ebAuq/I8qPT0ZH0Q8qvR81Ldi/keVlvasUYmeQnr8XZcjLlEzMt71HZEZFbyHCxkHqe1Cpcl38ItT1in6uET7bX1JYbaQIjNSVYTxcCEBaT/Wvq5+8ItT9ZdpACET6fcvtU4BmaZZtGIOnMc/XDUEBB/y5tLguQe/uFRm6258G52oSagtgJLGACLl0wNCHBPo1OPn6onb0g5+AdQDIiSqcnpGZrMgKZ9uwAxx0KRb+ittv9jBL1BC86SkRO3XiU9Tdo6dko8B5Lfo5TDb2IBK20djM9q3o8ocQAEsaM4q1s+qkKqL8VucKhbAB7GcdGUDwiYq+kclOdz2/YNMJ+3bijGbeQsQNpG9yIsUGpSk0ECrX4LnfVQpM1C0bB2X6PHO/iKRGSkn2/U4WYFigKNK22hehxsFOppvABESFXry8uI9KaNcjwhSH85eo+hxVOkJy/JBIfaLnZ5sJx1gv9jpyQIU4qjS05PlpEMcVXp6ouwXO0vJxCEgAQRIAAESQIAEECABBEgAARJAgAQQIAEESAABEkCABBAgAQRIAAESQIAEECABBEgAARJAgAQQIAEESAABEkCAUgek1oE5T+aLrdQBmaPVFlPqgKry8sev/I4N81PygAKsv/VS+oDKZdcsJQ9ov/3zogtykgdU3Pzf+9WUPkodkNpN63d6qqdSB6TXNy/oplMHtLgEECABBEgAARJAgAQQIAEESAABEkCABBAgAQRIAAESQIAEECABBEgAARJAgAQQIAEESAABEkCABBAgAQRIAAH6DdEuh28MSWzWAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#curve(x^2*exp(-x^2/2)/sqrt(2*pi),0,1,lty=2,add=T,col=&quot;blue&quot;)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#legend( &quot;topright&quot;,inset=.01, title=&quot;importance function&quot;, c(&quot;f&quot;,&quot;f1&quot;,&quot;f2&quot;,&quot;f3&quot;),lty=c(1, 2), pch=c(15, 17), col=c(&quot;blue&quot;, &quot;green&quot;,&quot;red&quot;,&quot;yellow&quot;))</span></span></code></pre></div>
<p>According to the above pictures,we choose 3 importance functions.in the interval of (0,1),the curve of <span class="math inline">\(f_3=3x^2\)</span> resembles the curve of <span class="math inline">\(f(x)=\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}\)</span> mostly,so we can guess the effect of <span class="math inline">\(f_3\)</span> is best.Then we use these three importance functions to estimate the values and standard error of calculus.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(m)<span class="co"># using f</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>f_0<span class="ot">&lt;-</span><span class="fu">f</span>(x)<span class="co">#f_0 represents f(x)/1</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(f_0)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(f_0)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rexp</span>(m,<span class="dv">1</span>)<span class="co">#using f1</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>f_1<span class="ot">&lt;-</span><span class="fu">f</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="co">#f_1 represents f(x)/f1</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(f_1)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(f_1)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)<span class="co">#using f2</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>f_2<span class="ot">&lt;-</span><span class="fu">f</span>(x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="co">#f_2 represents f(x)/f2</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(f_2)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(f_2)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(m)<span class="co">#using f3</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>x<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="co"># inverse transform method</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>f_3<span class="ot">&lt;-</span><span class="fu">f</span>(y)<span class="sc">/</span>(<span class="dv">3</span><span class="sc">*</span>(y<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">mean</span>(f_3)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">sd</span>(f_3)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>calculus<span class="ot">&lt;-</span><span class="fl">0.5</span><span class="sc">-</span>theta.hat</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>x_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">rbind</span>(theta.hat,calculus,se)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">12</span>)<span class="co">#set the size of words in the table</span></span></code></pre></div>
<table class="table table-hover" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
theta.hat
</td>
<td style="text-align:right;">
0.0994584
</td>
<td style="text-align:right;">
0.0981441
</td>
<td style="text-align:right;">
0.0979356
</td>
<td style="text-align:right;">
0.0991599
</td>
</tr>
<tr>
<td style="text-align:left;">
calculus
</td>
<td style="text-align:right;">
0.4005416
</td>
<td style="text-align:right;">
0.4018559
</td>
<td style="text-align:right;">
0.4020644
</td>
<td style="text-align:right;">
0.4008401
</td>
</tr>
<tr>
<td style="text-align:left;">
se
</td>
<td style="text-align:right;">
0.0775879
</td>
<td style="text-align:right;">
0.1594336
</td>
<td style="text-align:right;">
0.2156261
</td>
<td style="text-align:right;">
0.0132546
</td>
</tr>
</tbody>
</table>
<p>From the results in the table of calculus and standard error, we can see when we use <span class="math inline">\(3x^2\)</span> as the importance function, the values of calculus is most approximately equal to the real values of this calculus,and its standard error is only0.0132546,so we can choose it as a importance function among these three functions.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">integrate</span>(f,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(y)</span></code></pre></div>
<pre><code>## 0.09937402 with absolute error &lt; 1.1e-15</code></pre>
<p>And then we use the function of integrate() to calculate the value of <span class="math inline">\(\int_0^{1}\frac{x^{2}}{\sqrt{2\pi}}\exp{\frac{-x^2}{2}}dx\)</span>,from the result,we can see using <span class="math inline">\(3x^2\)</span> as importance function is also the best choice.</p>
</div>
</div>
<div id="section-7" class="section level1">
<h1>2021-10-14</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5and 6.A(page180-181,Statistical Computating with R).</p>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>1:What is the corresponding hypothesis test problem?</p>
<p>2: What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?Why?</p>
<p>3: Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answers-1" class="section level2">
<h2>Answers</h2>
<p><br />
6.5:<br />
</p>
<p>This question aims to estimate a 95% symmetric t-interval for the mean of a R-square distribution,For the normal distribution,we can use the following pivotal quantity to estimate the mean of distribution with unknown variance. <span class="math display">\[\frac{\sqrt{n}(\bar{X}-\mu)}{s}\sim t(n-1)\]</span> So in this question,we just use the samples of R-square distribution to replace the normal distribution.</p>
<p>for the level 0.05,the two sides <span class="math inline">\(100(1-\alpha)\)</span> confidence interval of mean is <span class="math display">\[(\bar{X}-\frac{S*t_{0.95}(n-1)}{\sqrt{n}}
,\bar{X}+\frac{S*t_{0.95}(n-1)}{\sqrt{n}})\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span><span class="co">#the number of samples of R-square distribution</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>func<span class="ot">&lt;-</span><span class="cf">function</span>(n,alpha)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  sp<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  es1<span class="ot">&lt;-</span><span class="fu">mean</span>(sp)<span class="sc">-</span><span class="fu">sd</span>(sp)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  es2<span class="ot">&lt;-</span><span class="fu">mean</span>(sp)<span class="sc">-</span><span class="fu">sd</span>(sp)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(es1,es2))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>level<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">100000</span>,<span class="fu">func</span>(n,alpha))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>upper<span class="ot">&lt;-</span>level[<span class="dv">1</span>,]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>lower<span class="ot">&lt;-</span>level[<span class="dv">2</span>,]</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>interval<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(lower),<span class="fu">mean</span>(upper))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>real_alpha<span class="ot">&lt;-</span><span class="fu">sum</span>(lower<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">&amp;</span>upper<span class="sc">&gt;</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">100000</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>interval</span></code></pre></div>
<pre><code>## [1] 1.104049 2.900605</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>real_alpha</span></code></pre></div>
<pre><code>## [1] 0.91807</code></pre>
<p>For this case,we use the pivotal quantity to conduct 100000 simulations to estimate the interval with the level of <span class="math inline">\(\alpha=0.05\)</span>,and then we get 100000 intervals of <span class="math inline">\(\mu\)</span>,and the mean of lower bounder and upper bounder are 1.1040488 and 2.9006048,so the interval is (1.1040488, 2.9006048).Besides,the frequency of <span class="math inline">\(\mu=2\)</span> lies to the interval is 0.91807,compared with example 6.4, the UCL is approximately 0.773, which is much smaller than the 0.91807, so we can conclude the t-interval should be more robust to departures from normality than the interval for variance.</p>
<p><br />
6.A<br />
</p>
<p>This question aims to use the Monte Carlo method to have a hypothesis test for the parameter <span class="math inline">\(\mu\)</span> for various distributions (i)χ2(1),(ii)Uniform(0,2),(iii)Exponential(rate=1),and the hypothesis test as follows: <span class="math display">\[ \mu=\mu_{0} \quad vs\quad\mu\neq\mu_{0}\]</span> For the following simulations,we choose the number of samples as 100,and the pivotal quantity is <span class="math display">\[T^{\ast}=\frac{\bar{X}-\mu_{0}}{S/\sqrt{100}}\sim t(99)\]</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># chi-square distribution</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>mu_0<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># the expectation of χ2(1).</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(N)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">rchisq</span>(N,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>qt<span class="ot">&lt;-</span>(<span class="fu">mean</span>(sp)<span class="sc">-</span>mu_0)<span class="sc">*</span><span class="fu">sqrt</span>(N)<span class="sc">/</span><span class="fu">sd</span>(sp)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(qt)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">10000</span>,<span class="fu">f1</span>(N))<span class="co">#the p_value of 100000 simulations</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>N<span class="dv">-1</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>N<span class="dv">-1</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>p_chisq<span class="ot">&lt;-</span><span class="fu">sum</span>(p1<span class="sc">&lt;</span>x1<span class="sc">|</span>p1<span class="sc">&gt;</span>x2)<span class="sc">/</span><span class="dv">10000</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>se.hat1<span class="ot">&lt;-</span><span class="fu">sqrt</span>((p_chisq)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(p_chisq))<span class="sc">/</span><span class="dv">10000</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># uniform(0,2) distribution</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>mu_0<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># the expectation of χ2(1).</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(N)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">runif</span>(N,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>qt<span class="ot">&lt;-</span>(<span class="fu">mean</span>(sp)<span class="sc">-</span>mu_0)<span class="sc">*</span><span class="fu">sqrt</span>(N<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sd</span>(sp)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(qt)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">100000</span>,<span class="fu">f2</span>(N))<span class="co">#the p_value of 10000 simulations</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>N<span class="dv">-1</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>N<span class="dv">-1</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>p_unif<span class="ot">&lt;-</span><span class="fu">sum</span>(p2<span class="sc">&lt;</span>x1<span class="sc">|</span>p2<span class="sc">&gt;</span>x2)<span class="sc">/</span><span class="dv">100000</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>se.hat2<span class="ot">&lt;-</span><span class="fu">sqrt</span>((p_unif)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(p_unif))<span class="sc">/</span><span class="dv">100000</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co">#exp(1) distribution</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>mu_0<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co"># the expectation of exp(1).</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>f3<span class="ot">&lt;-</span><span class="cf">function</span>(N)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">rexp</span>(N)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>qt<span class="ot">&lt;-</span>(<span class="fu">mean</span>(sp)<span class="sc">-</span>mu_0)<span class="sc">*</span><span class="fu">sqrt</span>(N<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sd</span>(sp)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(qt)</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">100000</span>,<span class="fu">f3</span>(N))<span class="co">#the p_value of 100000 simulations</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>N<span class="dv">-1</span>)</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>N<span class="dv">-1</span>)</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>p_exp<span class="ot">&lt;-</span><span class="fu">sum</span>(p3<span class="sc">&lt;</span>x1<span class="sc">|</span>p3<span class="sc">&gt;</span>x2)<span class="sc">/</span><span class="dv">100000</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>se.hat3<span class="ot">&lt;-</span><span class="fu">sqrt</span>((p_exp)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(p_exp))<span class="sc">/</span><span class="dv">100000</span>)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="co">#make the table</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>x_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(p_chisq,p_unif,p_exp)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
p_chisq
</th>
<th style="text-align:right;">
p_unif
</th>
<th style="text-align:right;">
p_exp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0633
</td>
<td style="text-align:right;">
0.04883
</td>
<td style="text-align:right;">
0.05725
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>y_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(se.hat1,se.hat2,se.hat3)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(y_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
se.hat1
</th>
<th style="text-align:right;">
se.hat2
</th>
<th style="text-align:right;">
se.hat3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.002435
</td>
<td style="text-align:right;">
0.0006815
</td>
<td style="text-align:right;">
0.0007347
</td>
</tr>
</tbody>
</table>
<p>From the table,we can see the empirical type one error rate of three distributions are 0.0633,0.04883,0.05725,which are equal to the <span class="math inline">\(\alpha=0.05\)</span> closely ,and the stand error of them are approximately close to the <span class="math inline">\(10^{-4}\)</span>,so we can conclude that t-test is robust to mild departures from normality.</p>
<p><br />
question in ppt<br />
This question aims to discuss how to test whether the powers are different at two methods at 0.05 level.</p>
<p>So at first we should know how to calculate the powers of a simulation with experiments.</p>
<p>As for the definition of power<span class="math display">\[power=P_{H_{0}}(p_{value}&lt;\alpha)\]</span></p>
<p>it equals with <span class="math inline">\(\frac{\sum_{i=1}^{N}I(p_{value_{(i)}}&lt;\alpha)}{N}\)</span>, and<span class="math inline">\(\sum_{i=1}^{N}I(p_{value_{i}}&lt;\alpha)\sim B(N,p)\quad p=P(p_{value}&lt;\alpha)\)</span>,so we can conclude that <span class="math display">\[power\sim B(1,p)\quad p=P(p_{value}&lt;\alpha)\quad \]</span> when the parameter lies to the space of null hypothesis.</p>
<p>Therefore, according to the meaning of question,for two different methods, the powers of two methods are 0.651,0.676 respectively.So we can get <span class="math inline">\(power_{1}=\widehat{p1}\)</span>,<span class="math inline">\(power_{2}=\widehat{p2}\)</span></p>
<p>And because the number of simulations is 10000,so this question is transformed into the following hypothesis. <span class="math display">\[H_{0}:p_{1}=p_{2}\quad H_{1}:p_{1}\neq p_{2}\]</span> Next we use two different test methods to test this problem.</p>
<p>The first method is Z test, using large sample theory and slutsky theorem, we can get the following statistics:</p>
<p><span class="math display">\[\frac{\widehat{p_{1}}-\widehat{p_{2}}-(p_{1}-p_{2})}{\sqrt{\frac{\widehat{p_{1}}(1-\widehat{p_{1}})}{n}+\frac{\widehat{p_{2}}(1-\widehat{p_{2}})}{n}}}\sim N(0,1)\]</span> From the question, we can get <span class="math inline">\(\widehat{p_{1}}=0.651\)</span>,<span class="math inline">\(\widehat{p_{2}}=0.676\)</span>,so when the null hypothesis is true,the value of statistic is -1.65,so we can not reject the null hypothesis at the level of 0.05.</p>
<p>The second method is t-test,and the statistics as follows:</p>
<p><span class="math display">\[\frac{\widehat{p_{1}}-\widehat{p_{2}}-(p_{1}-p_{2})}{\sqrt{\frac{p_{1}(1-p_{1})}{n}+\frac{p_{2}(1-p_{2})}{n}}}\sim t(2n-2)\]</span> So we should get the sample variance additionally to get the value of this statistics.</p>
<p>For the two methods,the first one can get the value directly, but the results maybe unrobust.And the second one is more robust compared with the first one.</p>
<p>#2021-10-21</p>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
</div>
<div id="answers-2" class="section level2">
<h2>Answers</h2>
<p>The first question is to repeat the example 6.8 with multivariate distributions.</p>
<p>Firstly,the definition of skewness is <span class="math display">\[\beta_{1,d}=E[(X-\mu)^{T}\Sigma^{-1}(Y-\mu)]\]</span></p>
<p>Then the estimation of <span class="math inline">\(\beta_{1,d}\)</span> is <span class="math display">\[b_{1,d}=\frac{1}{n^{2}}\sum_{i,j=1}^{n}((X_{i}-\bar{X})^{T}\widehat{\Sigma}^{-1}(X_{j}-\bar{X}))^{3}\]</span></p>
<p><span class="math display">\[\frac{nb_{1,d}}{6}\sim\chi^{2}(\frac{d(d+1)(d+2)}{6})\quad n\rightarrow\infty\]</span></p>
<p>Besides,The asymptotic distribution of √b1 does not depend on the mean and variance of the sampled normal distribution, so the samples can be generated from the standard normal distribution.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#dimension of random vectors</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10000</span><span class="co">#numbers of experiment </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)<span class="co">#numbers of samples</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,(d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>))<span class="co">#0.95 quantile of chi-square distribution</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(N))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>mn<span class="ot">&lt;-</span><span class="cf">function</span>(n,d)<span class="co">#generate random vectors of standard multivariate normal distribution,r represents number of vectors.</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  mu<span class="ot">&lt;-</span><span class="fu">integer</span>(d)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">data=</span><span class="dv">0</span>,d,d)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">&lt;-</span><span class="fu">diag</span>(d)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n,mu,sigma)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>statistic<span class="ot">&lt;-</span><span class="cf">function</span>(X)<span class="co">#compute the value of estimator of skewness.</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">=</span><span class="fu">cov</span>(X,X)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">nrow</span>(X)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">=</span>X<span class="sc">%*%</span>(<span class="fu">solve</span>(sigma))<span class="sc">%*%</span>(<span class="fu">t</span>(X))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(mat<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">6</span><span class="sc">*</span>n))</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(N))<span class="co">#compute the rate of rejection of test.</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  sktests<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">scale</span>((<span class="fu">mn</span>(N[i],d)),<span class="at">center=</span>T,<span class="at">scale=</span>T)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    sktests[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">statistic</span>(x)<span class="sc">&gt;</span>cv)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  p_value[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(sktests)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="co">#make the table</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>y_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(N,p_value)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(y_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
p_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.0156
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0.0231
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.0356
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.0437
</td>
</tr>
<tr>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
0.0485
</td>
</tr>
</tbody>
</table>
<p>From the part of code,we can see with the increasing of numbers of samples,the rejection rate of <span class="math inline">\(\beta_{1d}=0\)</span> is more close to the defined rate <span class="math inline">\(\alpha=0.05\)</span>.In the code part,to avoid the situation that sample covariance matrix tends to degenerate with high dimension, we default the dimension of samples as 2.And as the size of samples close to the 500,the empirical rate close to <span class="math inline">\(\alpha\)</span>,it also turns out that the limit distribution of <span class="math inline">\(\frac{nb_{1,d}}{6}\)</span>is <span class="math display">\[\frac{nb_{1,d}}{6}\sim\chi^{2}(\frac{d(d+1)(d+2)}{6})\quad n\rightarrow\infty\]</span></p>
<p>To repeat the example 6.10 in multivariate normal distribution,we define <span class="math inline">\(X\sim N(\mu,I_{n})\)</span>,<span class="math inline">\(Y\sim N(\mu,100I_{n})\)</span>, and the contaminated multivariate normal distribution is <span class="math display">\[\epsilon X+(1-\epsilon)Y\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">2</span><span class="co">#dimension of random vectors</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">5000</span><span class="co">#numbers of experiment </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">250</span><span class="co">#numbers of samples</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>powe<span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)<span class="co">#power of test</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,(d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>))<span class="co">#0.95 quantile of chi-square distribution</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>statistic<span class="ot">&lt;-</span><span class="cf">function</span>(X)<span class="co">#compute the value of estimator of skewness.</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  sigma<span class="ot">=</span><span class="fu">cov</span>(X,X)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">nrow</span>(X)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">=</span>X<span class="sc">%*%</span>(<span class="fu">solve</span>(sigma))<span class="sc">%*%</span>(<span class="fu">t</span>(X))</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(mat<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">6</span><span class="sc">*</span>n))</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>{ </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>weight<span class="ot">&lt;-</span>epsilon[j]</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>sktests<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">size=</span>k<span class="sc">*</span>d,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>weight,weight))</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">array</span>(<span class="fu">rnorm</span>(k<span class="sc">*</span>d,<span class="dv">0</span>,sigma),<span class="at">dim=</span><span class="fu">c</span>(k,d))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">scale</span>(x,<span class="at">center=</span>T,<span class="at">scale=</span>T)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>((<span class="fu">statistic</span>(y))<span class="sc">&gt;=</span>cv)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>powe[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(powe)</span></code></pre></div>
<pre><code>##  [1] 0.0474 0.9484 0.9946 0.9968 0.9970 0.9948 0.9918 0.9920 0.9904 0.9882
## [11] 0.9872 0.9820 0.9804 0.9778 0.9734 0.9698 0.9688 0.9582 0.9652 0.9556
## [21] 0.9482 0.9502 0.9194 0.8808 0.8204 0.7572 0.6736 0.5984 0.5074 0.4310
## [31] 0.3498 0.2762 0.2186 0.1652 0.1290 0.0902 0.0604 0.0460</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, powe, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="st">&quot;power and epsilon&quot;</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.05</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2kDq2kGa227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///9Kv7W3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJlklEQVR4nO2djXrbNBhG1a2FZBsMGgq03YABzfgpM9tI2sb3f19Ykp1ITpxXsmVLsd/zbG1+rE/KqfxJThxZ5OQoInYDUoeCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCnJKgpXj2wXHTza24WKkfXSulIMBIBSlSFFS8hr++F+L8Xt37VNx8/sNKPnyhfoqbPF/Ln5v3Qpx9I1ufibNfrsQzXSD/dCWEeHWnH/+92Ohc3i42n4vzd4agXXmrxn9fFg+/vq/1oG0z7KBuBBekOdOvUVE0ci0feFoIcan7gbxZcP6h2qj8S693pTMjUvFKNZUgo7xZY7bdyhS0a4YVNJqgojN8FGKW5w9z2ahMWilu3sgfxcNFq2dS0r28f6nafHGf/6dKF899udo9XvQKVVp6m61kp6kEGeWNGgtts5W8eWkKMpphBY0m6CYvs0W5R8hfykqm/rjSVfFKZAszuUGmS2z5/OdLpVc/Xmw9q5JPUaoUZJY3aiw2Pv9bRzEEGc2wgjoSPgd9UE0/u6sygLxd/LhYLcUXi7O7TL+SbVfPzP6+easfn5XFVKfIld7cSNJmebtGUWabnaBaM7ZBXelHkEzEVTNUUi6S0G8LcX0rLmW+LlPNniD5Cs9//ryoCaoibQWZ5Y0a88cr/eiv+c6N1YxkBO31oKJNX89l9/liUaWkElOQzipPdUFVJLMH3Ryosfj1+NNLlY8T7kEHc5AebHTX0bq2LTQFrasUcWkJOpSDZodqVGze6KR3OAclIOjQKKb3CrWzlDOis+v8caGft3rQxerxtp6DylFsaY5i2/JGjcVm367kfmZ1HnsUS0DQbsJiTEBUXi3mh/rFV/MYPXexc9CBJF0La5c3n3q/zUyN86D4gp79U4xEr42Z9I/Vay+ncip7PL6dl1vtjWLn77K9vWHzx1w8vzZm0rvyVo0fZQZ6dXAmrZqRhCCvw6X0a6QgAAUBKAhwSu8HRYGCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQECCxInAyxBIUN1x/RBbX5Yw1JbEGFlbZ9ehgGFlTXoPyY/ypfQWoLQeQeZKoRot6dwlbZjvQE2Xtd2FpbEF2QYWPPTgqG4goStVHM/FW5Cltvy4aG3NAjnNjdVDd2fox9L2y93qQkqHzG6kXq2Zj9KD1B+rGtH6E3iGYoeg5qCGwk6WaNQ5DAKHZkI7EzOFFB7puKSKmoJ0FLIWbqS103DRv4hCu7UZxU1I+gTH3Dbya/cdXwxXOvcDFTUS+CNrfyS/56UYWGRTH8X+iYBD0t5NIb+lvYDV+xmbYgjx7kmaxHl4OUqmPhvJJ1OYoNOprFHsVavNRhe1LseVDyuYiCnKoLuaFNBkaxyQuqR6m/U8gcBMK1CTvoaHaKgoyi/RvqSdCmXH2k8avq3QUNlIt6mihWi6Otm1ZJm7YgY/4c8FDjYITTFKQOVjXoYHWaOWiQHnTSo1hWHYP1mIMGoqdRrFwaq3kN2akLcg4XImyvu9oIBPWbrE9fUM/DfRtBT3JdwqX7OrnHwo1R0PrsLpNLn3YyNGJBcpIjZzdN7/T4hRthDpLTZCmoaY7sF26Eo1jVg5ad1skf8zxI56Cs8QMLr3AhBfXSk1qOYl7L4R8LF/Al9ZOLTn8eZEcMbugE37RvCh04nhXWZ0OvNYRhuBEKMhex7l7veHPQ0yKZedA2ZiqjmO5EyfWgfmghSK4633nl4REL6rhv1cL1ISjortZmF/O65A0I11PWCD04em9YvxJR63r7GnaCxR3TKGZGjCmofnGPZh7mjd1MeFbvTnRBxRCPRvjqQ58jGvsTlEYOApSfF0bpQWmMYmie+LSQb6dFEhSUNm+YlZfFOz6MLQuDcQWF6Ujt3nKVNJ2WUJGJy6iCAqWidm/aS+Cb9g/z5xEFhRrM+utB6jy8KQpyzEFu4UYpyGUU2wJOJB9jDupWXe096TGOYmEY8zxIH0l0vP74gIK69aQ2SVp/lfBoEto4nkg+gKCOuajNMK+Hr2OfzTufSN6/oK6jWYuJ4ne66xyZKLqfBjxGQVUPOjJRdD+RfIyCit1GvvxjE8WUetDwOcjh3TD3E8lHOYq54Hoi+TjnQQHrHVJQu540HUEtc9FkBLUdzSjIqVzIDb3CURAIxxwEwsUYxfxGswkJMmr2qHZygnxzEQU5bR9yQ69wFFSPMuCb9k1NqKp1S9aT60FbMY7JeoKCzJpx/RTktJ1zwGCkIwikoskKqnIQSkXTFeS4hG5kQdGhIMBOUEMumrqgbQ5qykU9Cdq4LvIWH7Bwfj+C3Bd5S4XGXa0XQR5LdKXCblqU243rRZDrZ/Mxr7hSx5gWWT0pZg/yfG+vZ2q5yLuBnjkIfjYvyolakv+F9bsHQU6fzbseLg5LfVeLOA9KU9ChXc2tXOBmGP+TpN8ctOPoieQpjWJ79DmKHa3VXtwkeSZ/LIagIAAPVgE8WAVEO9Q4GfoQ5HCw6hYUPN/t6a7FO2zu0IPcgo5VkMPBqlvQ0QrCB6tuQccrKFBQCur2PAVRULfnKWjygsYEBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAoQUtDYX0Vt7Xz+gXsLzMkxW8Ux0XTq8IqAgucbXumqjdce/uLzvt56aVVwuNLYOYyicIP2h0HK2f8e/eF5eULB17TPP2psJJ0gvgVueOGTd8S8ub1288RFkFU9U0AvZv8uPXK07/sXVXa8cZBdPchfTCaBMA9Yd/+K53GO8BNUq9B8imkhUkPfFBO3iy6InPcy7XRG1JM1dTN1pv4v5Z8Bm0kzSWXmOinsWsYr7999mkh3mPXuQVVzb6nZB1Ip0J4qeM2mreJI5SO0YsoV6FpJ5jyNW8dz7UMMqLi8zE8QPD1YRFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIkL+jjXIivQpwq1pLUBT28uC7PqItE6oKqa3RHI3VB+eNV86KEQ5C6oKfFddwGpC4ozLm8HUhd0MP8On9cBPneTjtSF5Q/XAnx6j5e/ckLig0FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4HzL6KvRH2z9PAAAAAElFTkSuQmCC" /><!-- --></p>
<p>From the first part,we can see when the number of samples exceed 100,the effect of the empirical rate is significant.Considering the speed of computing and limit distribution of <span class="math inline">\(\beta_{1,d}\)</span>,we default the number of samples as 250, and the number of experiments is 5000,the significant level is 0.05,then we can get the plots of <span class="math inline">\(\epsilon\)</span> and power.From the plot we can get when <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span>,the power is0.0474 and 0.046,approximately 0.05,and when <span class="math inline">\(0 &lt;ε&lt; 1\)</span>, the empirical power of the test is greater than 0.05 and highest in the interval of (0,0.2). # 2021-10-28</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7,7.8,7.9 and 7.B (pages 213, Statistical Computating with R).</p>
<p><br />
7.7<br />
The question is about estimating the parameter <span class="math inline">\(\theta\)</span>,where <span class="math inline">\(\theta\)</span> is <span class="math display">\[\theta=\frac{\hat{\lambda_{1}}}{\sum_{i=1}^{5}\hat{\lambda_{i}}}\]</span>,let <span class="math inline">\(\hat{\lambda_{1}},\hat{\lambda_{2}},\hat{\lambda_{3}},\hat{\lambda_{4}},\hat{\lambda_{5}}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>.</p>
<p>Then we use the method of bootstrap to estimate the bias and standard error of <span class="math inline">\(\theta\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span> <span class="co"># number of replicates</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>statis<span class="ot">&lt;-</span><span class="cf">function</span>(X)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X),<span class="at">size=</span><span class="fu">nrow</span>(X),<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">nrow</span>(X))</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">rbind</span>(sp,X[index[i],])</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span>sp[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(sp))</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>stat<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(stat)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">replicate</span>(B,<span class="fu">statis</span>(scor))</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co">#mean(results)</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>b_boot<span class="ot">&lt;-</span><span class="fu">mean</span>(results)<span class="sc">-</span>theta</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>sd_boot<span class="ot">&lt;-</span><span class="fu">sd</span>(results)</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(b_boot,sd_boot),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00131 0.04753</code></pre>
<p>From the code, we define the number of replications as 2000, by using the method of bootstrap, we can find the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span> is only 0.0013086 and 0.0475284.</p>
<p><br />
7.8<br />
</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Jackknife</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>theta_star<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">nrow</span>(scor))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(scor))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(X))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  theta_star[i]<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  i<span class="sc">&lt;</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>b_jack<span class="ot">&lt;-</span>(<span class="fu">nrow</span>(scor)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_star)<span class="sc">-</span>theta)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>sd_jack<span class="ot">&lt;-</span>(<span class="fu">nrow</span>(scor)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(theta_star)<span class="sc">/</span><span class="fu">nrow</span>(scor))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(b_jack,sd_jack),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.00106914 0.04955231</code></pre>
<p>From the code,by using the method of Jackknife, we can find the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span> is only 0.0010691 and 0.0495523.</p>
<p><br />
7.9<br />
This question intends us to compute 95% percentile and BCa confidence intervals. As for the 95% percentile confidence interval, The quantiles of the empirical distribution are estimators of the quantiles of the sampling distribution of <span class="math inline">\(\theta\)</span>.So from the ecdf of the replicates, we can compute the <span class="math inline">\(\frac{\alpha}{2}\)</span> quantile <span class="math inline">\(\theta_{\frac{\alpha}{2}}\)</span> and the <span class="math inline">\((1-\frac{\alpha}{2})\)</span> quantile <span class="math inline">\(\theta_{1-\frac{\alpha}{2}}\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span> <span class="co"># number of replicates</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span><span class="co">#quantiles</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">numeric</span>(B) </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>statis<span class="ot">&lt;-</span><span class="cf">function</span>(X)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X),<span class="at">size=</span><span class="fu">nrow</span>(X),<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  sp<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">nrow</span>(X))</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    sp<span class="ot">&lt;-</span><span class="fu">rbind</span>(sp,X[index[i],])</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  sp<span class="ot">&lt;-</span>sp[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(sp))</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  stat<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stat)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">replicate</span>(B,<span class="fu">statis</span>(scor))</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">sort</span>(results)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>lower<span class="ot">&lt;-</span>results[B<span class="sc">*</span>alpha<span class="sc">/</span><span class="dv">2</span>]</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>upper<span class="ot">&lt;-</span>results[B<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>interval_perc<span class="ot">&lt;-</span><span class="fu">c</span>(lower,upper)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>interval_perc</span></code></pre></div>
<pre><code>## [1] 0.5232249 0.7076911</code></pre>
<p>In this part,we just use the function sort() to sort the results of replication from minimum to maximum. And then choose the No.50 and the No.1950 values as the bound of interval.we can get 95% percentile confidence interval is (0.5232249, 0.7076911)</p>
<p>Then we use compute the Bca confidence interval.For a <span class="math inline">\(100(1-\alpha)%\)</span> BCa bootstrap confidence interval compute: <span class="math display">\[\alpha_{1}=\phi(\hat{z_{0}}+\frac{\hat{z_{0}}+z_{\alpha/2}}{1-\hat{\alpha}(\hat{z_{0}}+z_{\alpha/2})}),\]</span> <span class="math display">\[\alpha_{2}=\phi(\hat{z_{0}}+\frac{\hat{z_{0}}+z_{1-\alpha/2}}{1-\hat{\alpha}(\hat{z_{0}}+z_{1-\alpha/2})}),\]</span> where <span class="math display">\[\hat{z_{0}}=\phi^{-1}(\frac{1}{B}\sum_{b=1}^{B}I(\hat{\theta^{(b)}}&lt;\hat{\theta}),\]</span> <span class="math display">\[\hat{\alpha}=\frac{\sum_{i=1}^{n}(\overline{\theta_{(.)}}-\theta_{(i)})^3}{(\sum_{i=1}^{n}((\overline{\theta_{(.)}}-\theta_{(i)}))^{2})^{3/2}},\]</span> So in this way we can get the Bca interval <span class="math display">\[(\hat{\theta^{\star}_{\alpha_{1}}},\hat{\theta^{\star}_{\alpha_{2}}})\]</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span> <span class="co"># number of replicates</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span><span class="co">#quantiles</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(scor))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>statis<span class="ot">&lt;-</span><span class="cf">function</span>(X)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  index<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X),<span class="at">size=</span><span class="fu">nrow</span>(X),<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  sp<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">nrow</span>(X))</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    sp<span class="ot">&lt;-</span><span class="fu">rbind</span>(sp,X[index[i],])</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  sp<span class="ot">&lt;-</span>sp[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  ev<span class="ot">&lt;-</span><span class="fu">eigen</span>(<span class="fu">cov</span>(sp))</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  stat<span class="ot">&lt;-</span><span class="fu">max</span>(ev<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">sum</span>(ev<span class="sc">$</span>values)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stat)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>boot_Bca<span class="ot">&lt;-</span><span class="cf">function</span>(X)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">replicate</span>(B,<span class="fu">statis</span>(X))</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">as.integer</span>(results<span class="sc">&lt;</span>theta)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>z0<span class="ot">&lt;-</span><span class="fu">qnorm</span>((<span class="fu">sum</span>(k)<span class="sc">/</span>B),<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fu">mean</span>(results)<span class="sc">-</span>results</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(<span class="dv">6</span> <span class="sc">*</span> <span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">1.5</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>alpha_1<span class="ot">&lt;-</span><span class="fu">pnorm</span>(z0<span class="sc">+</span>(z0<span class="sc">+</span><span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>(z0<span class="sc">+</span><span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>))))</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>alpha_2<span class="ot">&lt;-</span><span class="fu">pnorm</span>(z0<span class="sc">+</span>(z0<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>a<span class="sc">*</span>(z0<span class="sc">+</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))))</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">sort</span>(results)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>lower<span class="ot">&lt;-</span>results[B<span class="sc">*</span>alpha_1]</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>upper<span class="ot">&lt;-</span>results[B<span class="sc">*</span>alpha_2]</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>interval_bca<span class="ot">&lt;-</span><span class="fu">c</span>(lower,upper)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>interval_bca</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="fu">boot_Bca</span>(scor)</span></code></pre></div>
<pre><code>## [1] 0.5188175 0.7038305</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, index)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a> {</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a> x <span class="ot">&lt;-</span> data[index,]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a> ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a> theta <span class="ot">&lt;-</span> ev[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(ev)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(theta)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a> bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>scor,<span class="at">statistic =</span> stat, <span class="at">R =</span> B)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a> interval_boot<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(bootstrap_result, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a> y_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;perc&#39;</span><span class="ot">=</span>interval_perc,<span class="st">&#39;bca&#39;</span><span class="ot">=</span><span class="fu">boot_Bca</span>(scor),<span class="st">&#39;boot_perc&#39;</span><span class="ot">=</span>interval_boot<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],<span class="st">&#39;boot_bca&#39;</span><span class="ot">=</span>interval_boot<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>])),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(y_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
perc
</th>
<th style="text-align:right;">
bca
</th>
<th style="text-align:right;">
boot_perc
</th>
<th style="text-align:right;">
boot_bca
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5232249
</td>
<td style="text-align:right;">
0.5192308
</td>
<td style="text-align:right;">
0.5222275
</td>
<td style="text-align:right;">
0.5215103
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7076911
</td>
<td style="text-align:right;">
0.7107690
</td>
<td style="text-align:right;">
0.7073575
</td>
<td style="text-align:right;">
0.7063595
</td>
</tr>
</tbody>
</table>
<p>Then we use the function boot.ci to calculate the Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span> and verify the results of estimating.From the table,we can see the results is approximately equal to the results of boot.ci()</p>
<p><br />
7.B<br />
</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#N(0,1)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(1)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#numbers of experiment</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span><span class="co">#numbers of random numbers</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>normal<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>basic<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>percent<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>func<span class="ot">&lt;-</span><span class="cf">function</span>(x,indices)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  mu2<span class="ot">&lt;-</span><span class="fu">var</span>(x[indices,])</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  mu3<span class="ot">&lt;-</span><span class="fu">mean</span>((x[indices,]<span class="sc">-</span><span class="fu">mean</span>(x[indices,]))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  sk<span class="ot">&lt;-</span>mu3<span class="sc">/</span>mu2<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sk)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>))</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="fu">boot</span>(x,<span class="at">statistic=</span>func, <span class="at">R=</span>B)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(sk,<span class="at">type=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>normal[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>((ci<span class="sc">$</span>normal[<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;&amp;</span>ci<span class="sc">$</span>normal[<span class="dv">3</span>]<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>basic[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>((ci<span class="sc">$</span>basic[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;&amp;</span>ci<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>percent[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>((ci<span class="sc">$</span>percent[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;&amp;</span>ci<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>normal_rate1<span class="ot">&lt;-</span><span class="fu">sum</span>(normal)<span class="sc">/</span>N</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>basic_rate1<span class="ot">&lt;-</span><span class="fu">sum</span>(basic)<span class="sc">/</span>N</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>percent_rate1<span class="ot">&lt;-</span><span class="fu">sum</span>(percent)<span class="sc">/</span>N</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>y_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;perc&#39;</span><span class="ot">=</span>percent_rate1,<span class="st">&#39;basic&#39;</span><span class="ot">=</span>basic_rate1,<span class="st">&#39;normal&#39;</span><span class="ot">=</span>normal_rate1)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(y_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
perc
</th>
<th style="text-align:right;">
basic
</th>
<th style="text-align:right;">
normal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
0.915
</td>
<td style="text-align:right;">
0.914
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#chi-square</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(1)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span><span class="co">#numbers of experiment</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span><span class="co">#numbers of random numbers</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>normal<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>basic<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>percent<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>func<span class="ot">&lt;-</span><span class="cf">function</span>(x,indices)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  mu2<span class="ot">&lt;-</span><span class="fu">var</span>(x[indices,])</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  mu3<span class="ot">&lt;-</span><span class="fu">mean</span>((x[indices,]<span class="sc">-</span><span class="fu">mean</span>(x[indices,]))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  sk<span class="ot">&lt;-</span>mu3<span class="sc">/</span>mu2<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sk)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">rchisq</span>(<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="fu">boot</span>(x,<span class="at">statistic=</span>func, <span class="at">R=</span>B)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>ci<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(sk)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>normal[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>((ci<span class="sc">$</span>normal[<span class="dv">2</span>]<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">&amp;&amp;</span>ci<span class="sc">$</span>normal[<span class="dv">3</span>]<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)))</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>basic[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>((ci<span class="sc">$</span>basic[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">&amp;&amp;</span>ci<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)))</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>percent[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>((ci<span class="sc">$</span>percent[<span class="dv">4</span>]<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)<span class="sc">&amp;&amp;</span>ci<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">5</span>)))</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>normal_rate2<span class="ot">&lt;-</span><span class="fu">sum</span>(normal)<span class="sc">/</span>N</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>basic_rate2<span class="ot">&lt;-</span><span class="fu">sum</span>(basic)<span class="sc">/</span>N</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>percent_rate2<span class="ot">&lt;-</span><span class="fu">sum</span>(percent)<span class="sc">/</span>N</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>y_html <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;perc&#39;</span><span class="ot">=</span>percent_rate2,<span class="st">&#39;basic&#39;</span><span class="ot">=</span>basic_rate2,<span class="st">&#39;normal&#39;</span><span class="ot">=</span>normal_rate2)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(y_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
perc
</th>
<th style="text-align:right;">
basic
</th>
<th style="text-align:right;">
normal
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.745
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.767
</td>
</tr>
</tbody>
</table>
<p>At the rate of 0.95, we can when the samples are from the normal distributions,the coverage rate is very close to the 0.95,but when the samples are from the chi-square distributions,the coverage rate is only 70 percent.</p>
<p>#2021-11-04</p>
<p>##Question</p>
<p>Exercise 8.2(page242,Statistical Computating with R). Design experiments for evaluating the performance of the NN,energy,and ball methods in various situations.</p>
<p>1:Unequal variances and equal expectations.</p>
<p>2:Unequal variances and unequal expectations.</p>
<p>3:Non-normal distributions:t distribution with 1 df(heavy-tailed distribution),bimodel distribution(mixture of two normal distributions).</p>
<p>4:Unbalanced samples(say,1 case versus 10controls).</p>
<p>5:Note:The parameters should be chosen such that the powers are distinguishable(say,range from 0.3 to 0.8).</p>
<p><br />
8.2<br />
</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span>iris</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">999</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">2</span>])</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">3</span>])</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">length</span>(z)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>per<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">numeric</span>(R)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>K<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>per</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span>(<span class="fu">cor.test</span>(x,y))<span class="sc">$</span>estimate</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  per<span class="ot">&lt;-</span><span class="fu">sample</span>(K,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  sp_x<span class="ot">&lt;-</span>z[per]</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  sp_y<span class="ot">&lt;-</span>z[<span class="sc">-</span>per]</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  results[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(sp_x,sp_y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>pvalue<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t,results))<span class="sc">&gt;</span><span class="fu">abs</span>(t))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(pvalue,(<span class="fu">cor.test</span>(x,y))<span class="sc">$</span>p.value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.212 0.217</code></pre>
<p>In the simulation of 8.2,we use the iris as the data set to calculate the Spearman rank correlation test. And we use the permutation test and function cor.test() respectively. With the number of experiments is 1000,we can find the p_value of two methods is 0.212 and 0.2169789 respectively, we can see these two values are very close to each other.</p>
<p><br />
question 2<br />
This question aims to design experiments for evaluating the performance of the NN,energy,and ball methods in various situations.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">##NN test</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">500</span><span class="co">#number of experiments</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>NN<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>energy<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>Ball<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>Tn<span class="ot">&lt;-</span><span class="cf">function</span>(z, index,length,k)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">&lt;-</span>length[<span class="dv">1</span>] </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">&lt;-</span>length[<span class="dv">2</span>] </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span>n1<span class="sc">+</span>n2</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z))</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span>z[index, ]</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  NN_result<span class="ot">&lt;-</span><span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  part_1<span class="ot">&lt;-</span> NN_result<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  part_2<span class="ot">&lt;-</span> NN_result<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  result1<span class="ot">&lt;-</span> <span class="fu">sum</span>(part_1<span class="sc">&lt;=</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  result2<span class="ot">&lt;-</span> <span class="fu">sum</span>(part_2<span class="sc">&gt;=</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((result1<span class="sc">+</span>result2)<span class="sc">/</span>(k <span class="sc">*</span> n))</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co">#N&lt;-c(nrow(x),nrow(y))</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>NN_test<span class="ot">&lt;-</span><span class="cf">function</span>(data,stat,k)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  boot_results<span class="ot">&lt;-</span><span class="fu">boot</span>(data,Tn,<span class="at">R=</span><span class="dv">999</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="at">length=</span>N,<span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  p_value<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">c</span>(boot_results<span class="sc">$</span>t0,boot_results<span class="sc">$</span>t)<span class="sc">&gt;</span>boot_results<span class="sc">$</span>t0)</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p_value)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="co">#equal expectation and unequal variance</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>k,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span>k)</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>k,<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="at">ncol=</span>k)</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">nrow</span>(x),<span class="fu">nrow</span>(y))</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>NN[i]<span class="ot">&lt;-</span><span class="fu">NN_test</span>(z,Tn,k)</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>energy[i]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>Ball[i]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>NN_pvalue_1<span class="ot">&lt;-</span><span class="fu">mean</span>(NN<span class="sc">&lt;</span>alpha)</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>energy_pvalue_1<span class="ot">&lt;-</span><span class="fu">mean</span>(energy<span class="sc">&lt;</span>alpha)</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>Ball_pvalue_1<span class="ot">&lt;-</span><span class="fu">mean</span>(Ball<span class="sc">&lt;</span>alpha)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;NN1&#39;</span><span class="ot">=</span>NN_pvalue_1,<span class="st">&#39;energy_1&#39;</span><span class="ot">=</span>energy_pvalue_1,<span class="st">&#39;Ball_1&#39;</span><span class="ot">=</span>Ball_pvalue_1)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
NN1
</th>
<th style="text-align:right;">
energy_1
</th>
<th style="text-align:right;">
Ball_1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.328
</td>
<td style="text-align:right;">
0.392
</td>
<td style="text-align:right;">
0.892
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="co">#equal expectation and unequal variance</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>k,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span>k)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>k,<span class="fl">1.5</span>,<span class="fl">1.5</span>),<span class="at">ncol=</span>k)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">nrow</span>(x),<span class="fu">nrow</span>(y))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>NN[i]<span class="ot">&lt;-</span><span class="fu">NN_test</span>(z,Tn,k)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>energy[i]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>Ball[i]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>NN_pvalue_2<span class="ot">&lt;-</span><span class="fu">mean</span>(NN<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>energy_pvalue_2<span class="ot">&lt;-</span><span class="fu">mean</span>(energy<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>Ball_pvalue_2<span class="ot">&lt;-</span><span class="fu">mean</span>(Ball<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>y_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;NN2&#39;</span><span class="ot">=</span>NN_pvalue_2,<span class="st">&#39;energy_2&#39;</span><span class="ot">=</span>energy_pvalue_2,<span class="st">&#39;Ball_2&#39;</span><span class="ot">=</span>Ball_pvalue_2)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(y_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
NN2
</th>
<th style="text-align:right;">
energy_2
</th>
<th style="text-align:right;">
Ball_2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.663
</td>
<td style="text-align:right;">
0.696
</td>
<td style="text-align:right;">
0.946
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="co">#t(1) and bimodel distribution</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rt</span>(n1,<span class="dv">1</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  weight<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n2,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(p,<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> weight<span class="sc">*</span><span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>weight)<span class="sc">*</span><span class="fu">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">length</span>(x),<span class="fu">length</span>(y))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  NN[m]<span class="ot">&lt;-</span><span class="fu">NN_test</span>(z,Tn,k)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  energy[m]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  Ball[m]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span>m<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>NN_pvalue_3<span class="ot">&lt;-</span><span class="fu">mean</span>(NN<span class="sc">&lt;</span>alpha)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>energy_pvalue_3<span class="ot">&lt;-</span><span class="fu">mean</span>(energy<span class="sc">&lt;</span>alpha)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>Ball_pvalue_3<span class="ot">&lt;-</span><span class="fu">mean</span>(Ball<span class="sc">&lt;</span>alpha)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>z_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;NN3&#39;</span><span class="ot">=</span>NN_pvalue_3,<span class="st">&#39;energy_3&#39;</span><span class="ot">=</span>energy_pvalue_3,<span class="st">&#39;Ball_3&#39;</span><span class="ot">=</span>Ball_pvalue_3)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(z_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
NN3
</th>
<th style="text-align:right;">
energy_3
</th>
<th style="text-align:right;">
Ball_3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.566
</td>
<td style="text-align:right;">
0.647
</td>
<td style="text-align:right;">
0.599
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="co">#Unbalanced samples</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span>k,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ncol=</span>k)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span><span class="sc">*</span>k,<span class="fl">1.5</span>,<span class="fl">1.5</span>),<span class="at">ncol=</span>k)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">nrow</span>(x),<span class="fu">nrow</span>(y))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>NN[i]<span class="ot">&lt;-</span><span class="fu">NN_test</span>(z,Tn,k)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>energy[i]<span class="ot">&lt;-</span><span class="fu">eqdist.etest</span>(z, <span class="at">sizes=</span>N, <span class="at">R=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>Ball[i]<span class="ot">&lt;-</span><span class="fu">bd.test</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">num.permutations=</span><span class="dv">999</span>)<span class="sc">$</span>p.value</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>NN_pvalue_4<span class="ot">&lt;-</span><span class="fu">mean</span>(NN<span class="sc">&lt;</span>alpha)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>energy_pvalue_4<span class="ot">&lt;-</span><span class="fu">mean</span>(energy<span class="sc">&lt;</span>alpha)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>Ball_pvalue_4<span class="ot">&lt;-</span><span class="fu">mean</span>(Ball<span class="sc">&lt;</span>alpha)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>z_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;NN4&#39;</span><span class="ot">=</span>NN_pvalue_4,<span class="st">&#39;energy_4&#39;</span><span class="ot">=</span>energy_pvalue_4,<span class="st">&#39;Ball_4&#39;</span><span class="ot">=</span>Ball_pvalue_4)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(z_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
NN4
</th>
<th style="text-align:right;">
energy_4
</th>
<th style="text-align:right;">
Ball_4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5593333
</td>
<td style="text-align:right;">
0.764
</td>
<td style="text-align:right;">
0.7306667
</td>
</tr>
</tbody>
</table>
<p>We get several results of simulations under the 4 kinds of background.</p>
<p>1:To make a equal distribution of two samples with equal expectations and unequal variances, we make two samples from <span class="math inline">\(N(0,0,1,1,0)\)</span> and <span class="math inline">\(N(0,0,1.5,1.5,0)\)</span>. Then using three methods to calculate the power of test with the level of 0.1. From the result, we can see Ball test are generally more powerful than nearest NN test and energy test.</p>
<p>2:Under the unequal expectations and variances background, we use two samples <span class="math inline">\(N(0,0,1,1,0)\)</span> and <span class="math inline">\(N(1.5,1.5,1.5,1.5,0)\)</span>, just like the circumstances of (1), Ball test are generally more powerful than nearest NN test and energy test.</p>
<p>3:When samples are from <span class="math inline">\(t(1)\)</span> and bimodel model, the bimodel is <span class="math display">\[\epsilon N(0,1)+(1-\epsilon)N(0,2)\quad \epsilon\sim b(1,0.5)\]</span>, the performance of ball method is worse than other two methods.</p>
<p>4:When the samples are unbalanced samples, we set the sample number of x as 20 ,the sample number of y as 200, we can see the ball method and the energy method is much better than the NN test.</p>
<p>In general,the performance of energy method and ball method is better than the NN test, but for energy method and ball method, which one is better depends on the samples concretely.</p>
<p>#2021-11-11</p>
<p>##Questions</p>
<p>1:Exercises 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p>
<p>2:For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span>&lt;1.2.</p>
<p><br />
9.3<br />
This question aims to use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. The key to use the Metropolis-Hastings sampler is finding a suitable proposal distribution.In this question, we define the normal distributions with different variances as the proposal distribution respectively, then define <span class="math display">\[\alpha(X_{t},y)=min(1,\frac{f(Y)g(X_{t}|Y)}{f(X_{t})g(Y|X_{t}))})\]</span> as the level of rejection.</p>
<p>And <span class="math inline">\(g(Y|X_{t})\)</span> is the <span class="math inline">\(N(0,|X_{t}|)\)</span>density evaluated at Y,and <span class="math inline">\(g(X_{t}|Y)\)</span>is the<span class="math inline">\(N(0,|Y|)\)</span>density evaluated at<span class="math inline">\(X_{t}\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(0)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">20000</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;&lt;-</span><span class="dv">2000</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>cauthy_chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,N,mu)<span class="co">#sigma is the parameter of proposal function,N is numbers of chains.</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>sd_cauthy<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a> y<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(y)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>xt<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>yt<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>xt[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,mu,sigma)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  yt[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,xt[i<span class="dv">-1</span>],sigma)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span><span class="fu">pmin</span>(<span class="dv">1</span>,((<span class="fu">sd_cauthy</span>(yt[i])<span class="sc">*</span><span class="fu">dnorm</span>(xt[i<span class="dv">-1</span>],yt[i],sigma))<span class="sc">/</span>(<span class="fu">sd_cauthy</span>(xt[i<span class="dv">-1</span>])<span class="sc">*</span><span class="fu">dnorm</span>(yt[i],xt[i<span class="dv">-1</span>],sigma))))</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(u<span class="sc">&lt;</span>r)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>    xt[i]<span class="ot">&lt;-</span>yt[i]</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    xt[i]<span class="ot">&lt;-</span>xt[i<span class="dv">-1</span>]</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(xt)</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>xt<span class="ot">&lt;-</span><span class="fu">cauthy_chain</span>(<span class="dv">1</span>,N,<span class="dv">0</span>)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)]</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>deciles<span class="ot">&lt;-</span><span class="fu">quantile</span>(xt,<span class="at">probs=</span>p)</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>decile_real<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="dv">1</span>)</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(decile_real,deciles),<span class="dv">3</span>),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
decile_real
</th>
<th style="text-align:right;">
deciles
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
10%
</td>
<td style="text-align:right;">
-3.078
</td>
<td style="text-align:right;">
-2.547
</td>
</tr>
<tr>
<td style="text-align:left;">
20%
</td>
<td style="text-align:right;">
-1.376
</td>
<td style="text-align:right;">
-1.185
</td>
</tr>
<tr>
<td style="text-align:left;">
30%
</td>
<td style="text-align:right;">
-0.727
</td>
<td style="text-align:right;">
-0.633
</td>
</tr>
<tr>
<td style="text-align:left;">
40%
</td>
<td style="text-align:right;">
-0.325
</td>
<td style="text-align:right;">
-0.259
</td>
</tr>
<tr>
<td style="text-align:left;">
50%
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.043
</td>
</tr>
<tr>
<td style="text-align:left;">
60%
</td>
<td style="text-align:right;">
0.325
</td>
<td style="text-align:right;">
0.362
</td>
</tr>
<tr>
<td style="text-align:left;">
70%
</td>
<td style="text-align:right;">
0.727
</td>
<td style="text-align:right;">
0.747
</td>
</tr>
<tr>
<td style="text-align:left;">
80%
</td>
<td style="text-align:right;">
1.376
</td>
<td style="text-align:right;">
1.328
</td>
</tr>
<tr>
<td style="text-align:left;">
90%
</td>
<td style="text-align:right;">
3.078
</td>
<td style="text-align:right;">
2.594
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the function of Gelman.Rubin</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin<span class="ot">&lt;-</span><span class="cf">function</span>(psi)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>psi<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(psi)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">ncol</span>(psi)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">nrow</span>(psi)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>psi.means<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(psi)<span class="co"># row means</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">var</span>(psi.means)<span class="co">#between variance est.</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>psi.w<span class="ot">&lt;-</span><span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)<span class="co">#within variances</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>W<span class="ot">&lt;-</span><span class="fu">mean</span>(psi.w)<span class="co">#within est.</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>v.hat<span class="ot">&lt;-</span>W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(B<span class="sc">/</span>n)<span class="co">#upper variance est.</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>r.hat<span class="ot">&lt;-</span>v.hat<span class="sc">/</span>W<span class="co">#G-R statistic</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the Gelman-Rubin statistics and make a plot of R</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">20000</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">&lt;&lt;-</span><span class="dv">2000</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>sp[i, ] <span class="ot">&lt;-</span> <span class="fu">cauthy_chain</span>(<span class="dv">1</span>,N,x0[i])</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(sp, <span class="dv">1</span>, cumsum))</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>psi[j,] <span class="ot">&lt;-</span> psi[j,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>rhat_cauthy<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span>(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>rhat_cauthy[k]<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>k])</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat_cauthy[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;N&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>By selecting different variance,we find the decile of cauthy distribution with proposal function <span class="math inline">\(N(0,1)\)</span> is most close to the real decile.from the table,we can see the 0.2 to 0.4 quantiles are more precise than other quantiles.</p>
<p>And the second part is about the monitoring covergence of the chain,we can calculate the <span class="math inline">\(\hat{R}\)</span> is about1.1542804 eventually, and from the plot of the <span class="math inline">\(\hat{R}\)</span>, we can see when the number of chains is about 8000,<span class="math inline">\(\hat{R}\)</span> will lower than 1.2,which means the covergence of the chain is significant.</p>
<p><br />
9.8  </p>
<p>This question consider the bivariate density that</p>
<p><span class="math display">\[f(x,y)\varpropto \dbinom{n}{x}y^{x+a+1}(1-y)^{n-x+b-1},x=0,1,.....n,0\leq y\leq 1.\]</span> and the conditional distribution <span class="math inline">\(f(x|y)\)</span> is Binomial(n,y) and <span class="math inline">\(f(y|x)\)</span> is Beta(x+a,n-x+b).</p>
<p>So we can conclude that <span class="math display">\[E(X|y)=ny \quad var(X|y)=ny(1-y)\]</span></p>
<p>and <span class="math display">\[E(Y|x)=\frac{x+a}{n+a+b}\quad var(Y|x)=\frac{(x+a)(n-x+b)}{(n+a+b)^2(n+a+b+1)}\]</span></p>
<p>Then we generate a chain with target joint density<span class="math inline">\(f(x,y)\)</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">15000</span><span class="co">#length of the chain</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>discard<span class="ot">&lt;-</span><span class="dv">1500</span><span class="co"># length of burn</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>sp[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(x0[<span class="dv">1</span>],y0[<span class="dv">1</span>])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>bivarate_chain<span class="ot">&lt;-</span><span class="cf">function</span>(a,b,n,x,y)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#x&lt;-sp[i-1,2]</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  sp[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,sp[i<span class="dv">-1</span>,<span class="dv">2</span>])</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  sp[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,(sp[i,<span class="dv">1</span>]<span class="sc">+</span>a),(n<span class="sc">-</span>x0<span class="sc">+</span>b))</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(sp)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>chain<span class="ot">&lt;-</span><span class="fu">bivarate_chain</span>(a,b,n,x0,y0)[((discard<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),]</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">colMeans</span>(chain)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;mean_binom&#39;</span><span class="ot">=</span>x[<span class="dv">1</span>],<span class="st">&#39;mean_beta&#39;</span><span class="ot">=</span>x[<span class="dv">2</span>])),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
mean_binom
</th>
<th style="text-align:right;">
mean_beta
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
29.89993
</td>
<td style="text-align:right;">
0.2990814
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the function of Gelman.Rubin</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin<span class="ot">&lt;-</span><span class="cf">function</span>(psi)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>psi<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(psi)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">ncol</span>(psi)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">nrow</span>(psi)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>psi.means<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(psi)<span class="co"># row means</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">var</span>(psi.means)<span class="co">#between variance est.</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>psi.w<span class="ot">&lt;-</span><span class="fu">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)<span class="co">#within variances</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>W<span class="ot">&lt;-</span><span class="fu">mean</span>(psi.w)<span class="co">#within est.</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>v.hat<span class="ot">&lt;-</span>W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(B<span class="sc">/</span>n)<span class="co">#upper variance est.</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>r.hat<span class="ot">&lt;-</span>v.hat<span class="sc">/</span>W<span class="co">#G-R statistic</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>bivarate_chain1<span class="ot">&lt;-</span><span class="fu">bivarate_chain</span>(a,b,n,x0[<span class="dv">1</span>],y0[<span class="dv">1</span>])</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>bivarate_chain2<span class="ot">&lt;-</span><span class="fu">bivarate_chain</span>(a,b,n,x0[<span class="dv">2</span>],y0[<span class="dv">2</span>])</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>bivarate_chain3<span class="ot">&lt;-</span><span class="fu">bivarate_chain</span>(a,b,n,x0[<span class="dv">3</span>],y0[<span class="dv">3</span>])</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>bivarate_chain4<span class="ot">&lt;-</span><span class="fu">bivarate_chain</span>(a,b,n,x0[<span class="dv">4</span>],y0[<span class="dv">4</span>])</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>xt1<span class="ot">=</span><span class="fu">rbind</span>(bivarate_chain1[,<span class="dv">1</span>],bivarate_chain2[,<span class="dv">1</span>] ,bivarate_chain3[,<span class="dv">1</span>] ,bivarate_chain4[,<span class="dv">1</span>])</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>xt2<span class="ot">=</span><span class="fu">rbind</span>(bivarate_chain1[,<span class="dv">2</span>],bivarate_chain2[,<span class="dv">2</span>] ,bivarate_chain3[,<span class="dv">2</span>],bivarate_chain4[,<span class="dv">2</span>])</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(xt1, <span class="dv">1</span>, cumsum))</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(xt2, <span class="dv">1</span>, cumsum))</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi1))</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>psi1[i,] <span class="ot">&lt;-</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>psi2[i,] <span class="ot">&lt;-</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi1),<span class="fu">Gelman.Rubin</span>(psi2)))</span></code></pre></div>
<pre><code>## [1] 1.114025 1.069551</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>rhat_binomal<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>rhat_beta<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span>(discard<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>rhat_binomal[k]<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="sc">:</span>k])</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>rhat_beta[k]<span class="ot">&lt;-</span><span class="fu">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="sc">:</span>k])</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat_binomal[(discard<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;N&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat_beta[(discard<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;N&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the results,we set <span class="math display">\[a=2,b=3,n=100,x_{0}=30,p=0.3\]</span>,so the mean of B(100,0.3) and Be(32,73) is 30 and <span class="math inline">\(\frac{32}{105}\)</span>,and the results of Gibbs sampling are 29.8999259,0.2990814respectively,which are approximately equal to the expectation of these two distributions.</p>
<p>The second question require us to use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}\)</span>&lt;1.2.</p>
<p>And then from the two plots of <span class="math inline">\(R^{2}\)</span>, we can see the speed of coveregence is apparently fast,when the chain is about 3000-4000,the <span class="math inline">\(R^{2}\)</span> is lower than 1.2.Eventually, the <span class="math inline">\(R^{2}\)</span> of two chains is about1.1140247 and 1.0695512</p>
<p>#2021-11-18</p>
<p>##Questions</p>
<p>Suppose<span class="math inline">\(T_{1},...,T_{n}\)</span>are i.i.d.samples drawn from the exponential distribution with expectation<span class="math inline">\(\lambda\)</span>.Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship,so that the observed values are<span class="math inline">\(Y_{i}=T_{i}I(T_{i}\leq\tau)+\tau I(T_{i}\leq\tau),i=1,...,n.\)</span> Suppose<span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_{i}\)</span> values areas follows: <span class="math display">\[0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85\]</span></p>
<p>Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>,compare your result with the observed data MLE(note:<span class="math inline">\(Y_{i}\)</span> follows a mixture distribution).</p>
<p><br />
11.3<br />
This question requires us to compute the kth term and sum of the following series.</p>
<p><span class="math display">\[\sum_{k=0}^{\infty}\frac{(-1)^{k}}{k!2^{k}}\frac{\parallel a \parallel^{k}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}\]</span></p>
<p>Before the experiment, we made a pre-experiment to get the numbers of covergence of the sum of series.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>error<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">100</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>fn<span class="ot">&lt;-</span><span class="cf">function</span>(a,d,m)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  series<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  k_norm<span class="ot">&lt;-</span><span class="cf">function</span>(a,k)<span class="co">#calculate the Kth norm of a vector</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    s<span class="ot">&lt;-</span>a<span class="sc">^</span>(<span class="dv">2</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    knorm<span class="ot">&lt;-</span>(<span class="fu">sum</span>(s))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span>))</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    knorm<span class="ot">&lt;-</span>knorm<span class="sc">^</span>k</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(knorm)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="cf">function</span>(a,d,k)<span class="co">#series</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    f1<span class="ot">&lt;-</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k)<span class="sc">/</span><span class="fu">prod</span>(<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    f2<span class="ot">&lt;-</span><span class="fu">k_norm</span>(a,<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    f3<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(f1<span class="sc">*</span>f2<span class="sc">*</span>f3)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  series[<span class="dv">1</span>]<span class="ot">&lt;-</span>(<span class="fu">k_norm</span>(a,<span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(series[k])<span class="sc">&gt;</span>error)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    series[k<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">f</span>(a,<span class="fu">length</span>(a),k)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>series<span class="ot">&lt;-</span>series[<span class="sc">-</span>(k<span class="sc">:</span>N)]</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>sum<span class="ot">&lt;-</span><span class="fu">cumsum</span>(series)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sum)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(series)</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="fu">fn</span>(a,<span class="dv">2</span>,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] 1.963495 1.349903 1.605567 1.505698 1.540652 1.529729 1.532794 1.532016
##  [9] 1.532196 1.532158 1.532165 1.532164 1.532164 1.532164 1.532164 1.532164
## [17] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [25] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [33] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [41] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [49] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [57] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [65] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [73] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
## [81] 1.532164 1.532164 1.532164 1.532164 1.532164 1.532164
##  [1]   1.963495e+00  -6.135923e-01   2.556635e-01  -9.986854e-02   3.495399e-02
##  [6]  -1.092312e-02   3.065162e-03  -7.782637e-04   1.801536e-04  -3.828265e-05
## [11]   7.514156e-06  -1.369768e-06   2.330227e-07  -3.715285e-08   5.572927e-09
## [16]  -7.891352e-10   1.058097e-10  -1.347114e-11   1.632582e-12  -1.887673e-13
## [21]   2.086714e-14  -2.209588e-15   2.245092e-16  -2.192473e-17   2.060924e-18
## [26]  -1.867332e-19   1.632955e-20  -1.379888e-21   1.128030e-22  -8.930238e-24
## [31]   6.853330e-25  -5.103188e-26   3.690322e-27  -2.593760e-28   1.773285e-29
## [36]  -1.180137e-30   7.650635e-32  -4.834629e-33   2.979924e-34  -1.792611e-35
## [41]   1.053066e-36  -6.044381e-38   3.391588e-39  -1.861344e-40   9.996106e-42
## [46]  -5.255514e-43   2.706269e-44  -1.365468e-45   6.753406e-47  -3.275402e-48
## [51]   1.558366e-49  -7.276024e-51   3.334952e-52  -1.501072e-53   6.636970e-55
## [56]  -2.883569e-56   1.231441e-57  -5.170661e-59   2.135256e-60  -8.674476e-62
## [61]   3.467692e-63  -1.364434e-64   5.285506e-66  -2.016261e-67   7.575890e-69
## [66]  -2.804436e-70   1.023004e-71  -3.678079e-73   1.303667e-74  -4.556183e-76
## [71]   1.570396e-77  -5.339166e-79   1.790910e-80  -5.927729e-82   1.936391e-83
## [76]  -6.243991e-85   1.987777e-86  -6.248561e-88   1.939847e-89  -5.948360e-91
## [81]   1.801915e-92  -5.393150e-94   1.595085e-95  -4.662505e-97   1.347125e-98
## [86] -3.847758e-100</code></pre>
<p>From the results of pre-experiment, we define the <span class="math inline">\(a\)</span> as <span class="math inline">\((1,2)^{\tau}\)</span>. we can see the sum of series converges when iterations just about 10 times.Besides,we set a threshold 10^{-100} for every kth term.Then we can find when the iteration times is about 80,the value of kth term is lower than the error.In this way,we can get the value of kth term and sum of the series.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>eplision<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">100</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>fn<span class="ot">&lt;-</span><span class="cf">function</span>(a,d,m)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  series<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  k_norm<span class="ot">&lt;-</span><span class="cf">function</span>(a,k)<span class="co">#calculate the Kth norm of a vector</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    s<span class="ot">&lt;-</span>a<span class="sc">^</span>(<span class="dv">2</span>)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    knorm<span class="ot">&lt;-</span><span class="fu">sum</span>(s)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    knorm<span class="ot">&lt;-</span>knorm<span class="sc">^</span>k</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(knorm)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  f<span class="ot">&lt;-</span><span class="cf">function</span>(a,d,k)<span class="co">#series</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    f1<span class="ot">&lt;-</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k)<span class="sc">/</span><span class="fu">prod</span>(<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">/</span><span class="dv">2</span><span class="sc">^</span>k</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    f2<span class="ot">&lt;-</span><span class="fu">k_norm</span>(a,<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    f3<span class="ot">&lt;-</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(f1<span class="sc">*</span>f2<span class="sc">*</span>f3)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  series[<span class="dv">1</span>]<span class="ot">&lt;-</span>(<span class="fu">k_norm</span>(a,<span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(series[k])<span class="sc">&gt;</span>eplision)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    series[k<span class="sc">+</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">f</span>(a,<span class="fu">length</span>(a),k)</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>series<span class="ot">&lt;-</span>series[<span class="sc">-</span>(k<span class="sc">:</span>N)]</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(series[m])</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">15</span>,<span class="dv">1</span>)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>series<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(m))</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m))</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>  series[i]<span class="ot">&lt;-</span><span class="fu">fn</span>(a,<span class="fu">length</span>(a),m[i])</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>sum<span class="ot">&lt;-</span><span class="fu">cumsum</span>(series)</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(sum,series),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
sum
</td>
<td style="text-align:right;">
1.963495
</td>
<td style="text-align:right;">
1.3499031
</td>
<td style="text-align:right;">
1.6055666
</td>
<td style="text-align:right;">
1.5056980
</td>
<td style="text-align:right;">
1.540652
</td>
<td style="text-align:right;">
1.5297289
</td>
<td style="text-align:right;">
1.5327940
</td>
<td style="text-align:right;">
1.5320158
</td>
<td style="text-align:right;">
1.5321959
</td>
<td style="text-align:right;">
1.5321577
</td>
<td style="text-align:right;">
1.5321652
</td>
<td style="text-align:right;">
1.5321638
</td>
<td style="text-align:right;">
1.5321640
</td>
<td style="text-align:right;">
1.532164
</td>
<td style="text-align:right;">
1.532164
</td>
</tr>
<tr>
<td style="text-align:left;">
series
</td>
<td style="text-align:right;">
1.963495
</td>
<td style="text-align:right;">
-0.6135923
</td>
<td style="text-align:right;">
0.2556635
</td>
<td style="text-align:right;">
-0.0998685
</td>
<td style="text-align:right;">
0.034954
</td>
<td style="text-align:right;">
-0.0109231
</td>
<td style="text-align:right;">
0.0030652
</td>
<td style="text-align:right;">
-0.0007783
</td>
<td style="text-align:right;">
0.0001802
</td>
<td style="text-align:right;">
-0.0000383
</td>
<td style="text-align:right;">
0.0000075
</td>
<td style="text-align:right;">
-0.0000014
</td>
<td style="text-align:right;">
0.0000002
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
</tr>
</tbody>
</table>
<p>From this part of code,we calculate the values of 1st to 15th term,And then get the cumulative sum of these terms, we can conclude the sum of series is about 1.532164.</p>
<p><br />
11.5<br />
This question require us to write a function to solve the equation <span class="math display">\[\frac{2\Gamma(\frac{k}{2})}{\sqrt{(\pi(k-1))}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}(1+\frac{u^{2}}{k-1})^{-\frac{k}{2}}du=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{(\pi(k))}\Gamma(\frac{k}{2})}\int_{0}^{c_{k}}(1+\frac{u^{2}}{k})^{-\frac{k+1}{2}}du\]</span> for a, where <span class="math display">\[c_{k}=\sqrt{\frac{a^2k}{k+1-a^2}}\]</span></p>
<p>From the expression of this equation, we can see the calculus in this equation is the cdf of the t-distribution. So we can transform this equation as <span class="math display">\[F_{t_{k-1}}(c_{k-1})=F_{t_{k}}(c_{k})\]</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co">#t-distribution</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>ck<span class="ot">&lt;-</span><span class="cf">function</span>(a,k)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>equation_k1<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a> eq<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),k[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">1</span>]),k[<span class="dv">1</span>])</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(eq)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>equation_k2<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a> eq<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>),k[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">2</span>]),k[<span class="dv">2</span>])</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(eq)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>equation_k3<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a> eq<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">1</span>),k[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">3</span>]),k[<span class="dv">3</span>])</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(eq)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>equation_k4<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a> eq<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">4</span>]<span class="sc">-</span><span class="dv">1</span>),k[<span class="dv">4</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">4</span>]),k[<span class="dv">4</span>])</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(eq)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>equation_k5<span class="ot">&lt;-</span><span class="cf">function</span>(a)</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a> eq<span class="ot">&lt;-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">5</span>]<span class="sc">-</span><span class="dv">1</span>),k[<span class="dv">5</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a,k[<span class="dv">5</span>]),k[<span class="dv">5</span>])</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(eq)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>solution_k1<span class="ot">=</span><span class="fu">uniroot</span>(equation_k1,<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k[<span class="dv">1</span>])),<span class="at">tol=</span><span class="fl">1e-10</span>)<span class="sc">$</span>root</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>solution_k2<span class="ot">=</span><span class="fu">uniroot</span>(equation_k2,<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k[<span class="dv">2</span>])<span class="sc">-</span><span class="fl">0.1</span>),<span class="at">tol=</span><span class="fl">1e-10</span>)<span class="sc">$</span>root</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>solution_k3<span class="ot">=</span><span class="fu">uniroot</span>(equation_k3,<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k[<span class="dv">3</span>])<span class="sc">-</span><span class="fl">0.1</span>),<span class="at">tol=</span><span class="fl">1e-10</span>)<span class="sc">$</span>root</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>solution_k4<span class="ot">=</span><span class="fu">uniroot</span>(equation_k4,<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k[<span class="dv">4</span>]<span class="sc">-</span><span class="fl">0.1</span>)),<span class="at">tol=</span><span class="fl">1e-10</span>)<span class="sc">$</span>root</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>solution_k5<span class="ot">=</span><span class="fu">uniroot</span>(equation_k5,<span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">sqrt</span>(k[<span class="dv">5</span>]<span class="sc">-</span><span class="dv">1</span>)),<span class="at">tol=</span><span class="fl">1e-10</span>)<span class="sc">$</span>root</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">rbind</span>(sum,series),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">cbind</span>(<span class="st">&#39;k=4&#39;</span><span class="ot">=</span>solution_k1,<span class="st">&#39;k=10&#39;</span><span class="ot">=</span>solution_k2,<span class="st">&#39;k=15&#39;</span><span class="ot">=</span>solution_k3,<span class="st">&#39;k=20&#39;</span><span class="ot">=</span>solution_k4,<span class="st">&#39;k=25&#39;</span><span class="ot">=</span>solution_k5)),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
k=4
</th>
<th style="text-align:right;">
k=10
</th>
<th style="text-align:right;">
k=15
</th>
<th style="text-align:right;">
k=20
</th>
<th style="text-align:right;">
k=25
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.492103
</td>
<td style="text-align:right;">
1.625383
</td>
<td style="text-align:right;">
1.659096
</td>
<td style="text-align:right;">
1.676614
</td>
<td style="text-align:right;">
1.687347
</td>
</tr>
</tbody>
</table>
<p>The question 11.5 I am not able to use the integrate() to calculate the value,so I just use the method of t distribution. From the results of code,we have calculated the roots in the interval of (0,<span class="math inline">\(\sqrt n\)</span>).Then we use the symmetry of the function,we can get 3 solutions of each k.</p>
<p><br />
question 3<br />
The question 3 requires us to make a comparison between the method of MLE and EM algorithm.</p>
<p>When using the method of MLE,we should calculate the joint distribution of <span class="math inline">\(Y_{i}(i=1,2,.....n)\)</span></p>
<p>As the <span class="math inline">\(\tau=1\)</span> and the expectation is <span class="math inline">\(\lambda\)</span>,we can get the joint distribution is <span class="math display">\[\frac{n!}{(n-r)!}(\frac{1}{\lambda})^{r}\exp^{-\frac{(n-r)+\sum_{i=1}^{n}Y_{i}}{\lambda}}\]</span></p>
<p>Then the log likelihood is <span class="math display">\[-\frac{(n-r)+\sum_{i=1}^{n}Y_{i}}{\lambda}-r\log(\lambda)\]</span></p>
<p>So we can use the mle function() to get the result.</p>
<p>In order to implementing the EM algorithm, we should get the E step and M step</p>
<p>E step:</p>
<p><span class="math display">\[l(\lambda|T_{1},T_{2}....T_{n})=n\log(\lambda)-\lambda\sum_{i=1}^{n}T_{i}\]</span> Then<span class="math display">\[Q(\lambda|\lambda_{t})=E(l(\lambda|T_{1},T_{2}....T_{n})|x,\lambda^{(i)})\]</span> <span class="math display">\[=n\log(\lambda)-\lambda\sum_{i=1}^{n}E(T_{i}|x_{i},\lambda^{t})\]</span> <span class="math display">\[=n\log(\lambda)-\lambda[\sum_{i=1}^{r}t_{i}+(n-r)]+\frac{(n-r)\lambda}{\lambda^{t}}\]</span> <span class="math inline">\(r\)</span> represents the number of observations <span class="math inline">\(t_{i}&gt;1\)</span></p>
<p>And then we can get the M step from the E step:</p>
<p>M step:</p>
<p><span class="math display">\[\frac{\partial Q}{\partial \lambda}=\frac{n}{\lambda}-(\sum_{i=1}^{r}t_{i}+(n-r))-\frac{(n-r)}{\lambda^{(t)}}=0\]</span> Then we can get <span class="math display">\[\frac{n}{\lambda^{(t+1)}}=(\sum_{i=1}^{r}t_{i}+(n-r))-\frac{(n-r)}{\lambda^{(t)}}\]</span></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MLE</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">as.integer</span>(sp<span class="sc">&lt;</span><span class="dv">1</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">as.integer</span>(sp<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>mlogL<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">theta=</span><span class="dv">1</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>{<span class="co">#minus log-likelihood of exp.density,rate1/theta</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>(<span class="sc">-</span>(<span class="fu">sum</span>(sp)<span class="sc">/</span>theta<span class="sc">+</span>n1<span class="sc">*</span><span class="fu">log</span>(theta)))</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="sc">-</span>y)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">mle</span>(mlogL)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## Maximum likelihood estimation
## 
## Call:
## mle(minuslogl = mlogL)
## 
## Coefficients:
##        Estimate Std. Error
## theta 0.9642705  0.3644531
## 
## -2 log L: 13.49085</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#EM</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>ep1<span class="ot">&lt;-</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">50</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>lambda[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>lambda[<span class="dv">2</span>]<span class="ot">&lt;-</span>(<span class="fu">sum</span>(sp)<span class="sc">+</span>n2<span class="sc">*</span>lambda[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">length</span>(sp)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(lambda[k<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span>lambda[k])<span class="sc">&gt;</span><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>))</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  lambda[k<span class="sc">+</span><span class="dv">2</span>]<span class="ot">=</span>(<span class="fu">sum</span>(sp)<span class="sc">+</span>n2<span class="sc">*</span>lambda[k<span class="sc">+</span><span class="dv">1</span>])<span class="sc">/</span><span class="fu">length</span>(sp)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(lambda[k<span class="sc">+</span><span class="dv">1</span>],k))</span></code></pre></div>
<pre><code>## [1]  0.9642859 10.0000000</code></pre>
<p>From the results,we can see the results of MLE and EM algorithm is the same as0.9642859, and the number of iterations of EM algorithm is only 10times.</p>
<p>#2021-11-25</p>
<p>##Questions Exercises 1 and 5(page204,Advanced R)</p>
<p>Exercises 1 and 7(page214,Advanced R)</p>
<p><br />
204-1<br />
</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>trims<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims,<span class="cf">function</span>(trim)<span class="fu">mean</span>(x,<span class="at">trim=</span>trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] -3.920647
## 
## [[2]]
## [1] -0.2409721
## 
## [[3]]
## [1] 0.00807126
## 
## [[4]]
## [1] 0.129289</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean,<span class="at">x=</span>x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] -3.920647
## 
## [[2]]
## [1] -0.2409721
## 
## [[3]]
## [1] 0.00807126
## 
## [[4]]
## [1] 0.129289</code></pre>
<p>From the results,we can see the results of these two methods are the same,but the process of invocations is not the same.The function lapply(x,fun,……) has main two parameters,the first main parameter is a list x,and the second main parameter is a function.The process of invocation is Passing each column of x to f and returns a new list.</p>
<p>So the process of the first invocation is <span class="math display">\[y=trims=\left\{\begin{array}{rl}0.1&amp; trims[1],\\0.2&amp;trims[2],\\0.5&amp;trims[3],\\1&amp;trims[4].\end{array}\right.\Longrightarrow list\left\{\begin{array}{rl}mean(x,y[1]),\\mean(x,y[2]),\\mean(x,y[3]),\\mean(x,y[4]).\end{array}\right.\]</span> when x is rcauthy().</p>
<p>x represents the rcauchy(100),so we find the function just use only 1 parameter trims.</p>
<p>And the process of the second invocation is <span class="math display">\[x=rcauchy(100)\Longrightarrow list\left\{\begin{array}{rl}mean(x,y[1]),\\mean(x,y[2]),\\mean(x,y[3]),\\mean(x,y[4]).\end{array}\right. \Longleftarrow y=trims=\left\{\begin{array}{rl}0.1&amp; trims[1],\\0.2&amp;trims[2],\\0.5&amp;trims[3],\\1&amp;trims[4].\end{array}\right.\]</span> So from the run of these two process,we can conclude the following two invocations of lapply() equivalent.</p>
<p><br />
204.5<br />
</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exercise 3</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>formulas<span class="ot">&lt;-</span><span class="fu">list</span>(mpg <span class="sc">~</span>disp,mpg <span class="sc">~</span><span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp),mpg <span class="sc">~</span>disp <span class="sc">+</span>wt,mpg <span class="sc">~</span><span class="fu">I</span>(<span class="dv">1</span><span class="sc">/</span>disp) <span class="sc">+</span>wt)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas,lm,mtcars)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode=</span><span class="st">&quot;list&quot;</span>,<span class="at">length=</span><span class="fu">length</span>(formulas))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(formulas))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  results[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(formulas[[i]],<span class="at">data=</span>mtcars)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#exercise 4</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>bootstraps<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i){</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  rows<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars),<span class="at">rep =</span><span class="cn">TRUE</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]})</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps,lm,mtcars)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat           wt  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711     -3.71530  
##        qsec           vs           am         gear         carb  
##     0.82104      0.31776      2.52023      0.65541     -0.19942</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode=</span><span class="st">&quot;list&quot;</span>,<span class="at">length=</span><span class="fu">length</span>(bootstraps))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bootstraps))</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  res[[i]]<span class="ot">&lt;-</span><span class="fu">lm</span>(bootstraps[[i]],<span class="at">data=</span>mtcars)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>rsq<span class="ot">&lt;-</span><span class="cf">function</span>(mod)<span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>reg<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">c</span>(results,res))</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>rsquare<span class="ot">&lt;-</span><span class="fu">lapply</span>(reg,rsq)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>((<span class="fu">rbind</span>(<span class="st">&#39;mpg~disp[1]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">1</span>]],<span class="st">&#39;mpg ~I(1/disp)&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">2</span>]],<span class="st">&#39;mpg ~disp +wt&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">3</span>]],<span class="st">&#39;mpg ~I(1/disp) +wt&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">4</span>]],<span class="st">&#39;mpg~disp[2]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">5</span>]],<span class="st">&#39;mpg~disp[3]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">6</span>]],<span class="st">&#39;mpg~disp[4]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">7</span>]],<span class="st">&#39;mpg~disp[5]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">8</span>]],<span class="st">&#39;mpg~disp[6]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">9</span>]],<span class="st">&#39;mpg~disp[7]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">10</span>]],<span class="st">&#39;mpg~disp[8]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">11</span>]],<span class="st">&#39;mpg~disp[9]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">12</span>]],<span class="st">&#39;mpg~disp[10]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">13</span>]],<span class="st">&#39;mpg~disp[11]&#39;</span><span class="ot">=</span>rsquare[[<span class="dv">14</span>]])),<span class="st">&quot;html&quot;</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
mpg~disp[1]
</td>
<td style="text-align:right;">
0.7183433
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg ~I(1/disp)
</td>
<td style="text-align:right;">
0.8596865
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg ~disp +wt
</td>
<td style="text-align:right;">
0.7809306
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg ~I(1/disp) +wt
</td>
<td style="text-align:right;">
0.8838038
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[2]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[3]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[4]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[5]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[6]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[7]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[8]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[9]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[10]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
<tr>
<td style="text-align:left;">
mpg~disp[11]
</td>
<td style="text-align:right;">
0.8690158
</td>
</tr>
</tbody>
</table>
<p>From this part of code,we calculate the 14 kinds of R-squares of these models,4 models are given in the list formulas(),and the next 10 models is stored in the list res() after bootstrapping.we can find the R-squares of models after bootstrapping are the same which are different form the models stored in formulas.</p>
<p><br />
214.1<br />
</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(a)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="cf">function</span>(x)<span class="co">#compute the standard deviation</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(df,sd,<span class="at">FUN.VALUE=</span><span class="dv">0</span>),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    X1    X2    X3    X4    X5    X6 
## 2.191 2.119 2.655 2.587 3.442 2.468</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(b)</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>name<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;zhang&quot;</span>, <span class="st">&quot;Li&quot;</span>, <span class="st">&quot;Wang&quot;</span>, <span class="st">&quot;Zhao&quot;</span>, <span class="st">&quot;Ding&quot;</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>age<span class="ot">=</span><span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">19</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>height<span class="ot">=</span><span class="fu">c</span>(<span class="fl">167.5</span>, <span class="fl">156.3</span>, <span class="fl">177.3</span>, <span class="fl">167.5</span>, <span class="fl">170.0</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>weight<span class="ot">=</span><span class="fu">c</span>(<span class="fl">55.0</span>, <span class="fl">60.0</span>, <span class="fl">63.0</span>, <span class="fl">53.0</span>, <span class="fl">69.5</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>mydataframe<span class="ot">&lt;-</span><span class="fu">data.frame</span>(name,sex,age,height,weight)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>logit<span class="ot">&lt;-</span><span class="fu">vapply</span>(mydataframe,is.numeric,<span class="at">FUN.VALUE=</span><span class="fu">c</span>(<span class="cn">FALSE</span>))</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>index<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">along=</span>logit)[logit<span class="sc">==</span><span class="cn">TRUE</span>]</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>mydataframe<span class="ot">&lt;-</span>mydataframe[,index]</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vapply</span>(mydataframe,sd,<span class="at">FUN.VALUE=</span><span class="dv">0</span>),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    age height weight 
##  1.166  6.745  5.886</code></pre>
<p>From this part, in order to compute the standard deviation of every numeric column in a mixed data frame.we use the vapply()firstly and is.numeric() to get a logic list. Then use the seq() to get the index of numeric columns.In this way,we can get the numeric columns and calculate the standard deviation of every column.</p>
<p>#2021-12-02</p>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise9.8(page278,Statistical Computing with R).</p>
<p>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<p>Compare the computation time of the two functions with the function “microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answers-3" class="section level2">
<h2>Answers</h2>
<p>This question consider the bivariate density that</p>
<p><span class="math display">\[f(x,y)\varpropto \dbinom{n}{x}y^{x+a+1}(1-y)^{n-x+b-1},x=0,1,.....n,0\leq y\leq 1.\]</span> and the conditional distribution <span class="math inline">\(f(x|y)\)</span> is Binomial(n,y) and <span class="math inline">\(f(y|x)\)</span> is Beta(x+a,n-x+b).</p>
<p>So we can conclude that <span class="math display">\[E(X|y)=ny \quad var(X|y)=ny(1-y)\]</span></p>
<p>and <span class="math display">\[E(Y|x)=\frac{x+a}{n+a+b}\quad var(Y|x)=\frac{(x+a)(n-x+b)}{(n+a+b)^2(n+a+b+1)}\]</span></p>
<p>Then we generate a chain with target joint density<span class="math inline">\(f(x,y)\)</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pure r code</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>pure_R<span class="ot">&lt;-</span><span class="cf">function</span>(N,discard)<span class="co">#N represents length of the chain,discard represents the length of the burn.</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">&lt;-</span><span class="dv">30</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">&lt;-</span><span class="fl">0.3</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>sp<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>sp[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">c</span>(x0,y0)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#x&lt;-sp[i-1,2]</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  sp[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,sp[i<span class="dv">-1</span>,<span class="dv">2</span>])</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  sp[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,(sp[i,<span class="dv">1</span>]<span class="sc">+</span>a),(n<span class="sc">-</span>x0<span class="sc">+</span>b))</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(sp)</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">15000</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>discard<span class="ot">&lt;-</span><span class="dv">1500</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>chain_R<span class="ot">&lt;-</span><span class="fu">pure_R</span>(N,discard)[((discard<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),]</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Rcpp function</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>func<span class="ot">&lt;-</span><span class="st">&#39;NumericMatrix chain(int N)</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="st">int a=2;</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="st">int b=3;</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="st">double n=100;</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="st">double x0=30;</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="st">double y0=0.3;</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="st">NumericMatrix sp(N,2);</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="st">sp(0,0)=x0;</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="st">sp(0,1)=y0;</span></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="st">for(int j=1;j&lt;N;j++)</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="st">{</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="st">  sp(j,0)=rbinom(1,n,sp(j-1,1))[0];</span></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="st">  sp(j,1)=rbeta(1,(sp(j,0)+a),(n-x0+b))[0];</span></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a><span class="st">return(sp);</span></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>( func )</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>chain_C<span class="ot">&lt;-</span><span class="fu">chain</span>(N)</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>chain_C<span class="ot">&lt;-</span>chain_C[((discard<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N),]</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(chain_C[,<span class="dv">1</span>],chain_R[,<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(chain_C[,<span class="dv">2</span>],chain_R[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>ts_1<span class="ot">&lt;-</span><span class="fu">microbenchmark</span>(<span class="at">meanR=</span><span class="fu">mean</span>(<span class="fu">pure_R</span>(<span class="dv">15000</span>)),<span class="at">meancpp=</span><span class="fu">mean</span>(<span class="fu">chain</span>(<span class="dv">15000</span>)))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>ts_1<span class="ot">&lt;-</span><span class="fu">summary</span>(ts_1)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>x_html<span class="ot">&lt;-</span>knitr<span class="sc">::</span><span class="fu">kable</span>(ts_1,<span class="st">&quot;html&quot;</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(x_html,<span class="at">bootstrap_options =</span> <span class="st">&quot;hover&quot;</span>,<span class="at">full_width =</span> <span class="cn">TRUE</span>,<span class="at">font_size=</span><span class="dv">10</span>)</span></code></pre></div>
<table class="table table-hover" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
expr
</th>
<th style="text-align:right;">
lq
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
uq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
meanR
</td>
<td style="text-align:right;">
85.287951
</td>
<td style="text-align:right;">
92.182051
</td>
<td style="text-align:right;">
97.667302
</td>
</tr>
<tr>
<td style="text-align:left;">
meancpp
</td>
<td style="text-align:right;">
7.101401
</td>
<td style="text-align:right;">
7.219651
</td>
<td style="text-align:right;">
7.769351
</td>
</tr>
</tbody>
</table>
<p>In this example,From the results,we set <span class="math display">\[a=2,b=3,n=100,x_{0}=30,p=0.3\]</span>,so the mean of B(100,0.3) and Be(32,73) is 30 and <span class="math inline">\(\frac{32}{105}\)</span>, the results of Gibbs sampling of pure R code are 30.0945185, 0.3008709respectively,and the results of Gibbs sampling of RCpp function are 29.8999259, 0.2990814respectively,which are approximately equal to the expectation of these two distributions.</p>
<p>According to the qqplot, we can see the random numbers generated from pure R code and rcpp function are approximately lying on the same line.</p>
<p>By using the function microbenchmark(), we can see the average implementing time of Rcpp function is only about 7. However, the average implementing time of pure R function is about 84. Therefore,the speed of implementing of Rcpp function is much faster than the pure R function.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
